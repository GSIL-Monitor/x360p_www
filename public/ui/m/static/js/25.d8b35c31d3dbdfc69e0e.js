webpackJsonp([25],{"6v+Q":function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n("MVMM"),r=(i(a),n("6ROu")),o=i(r),u=n("TVG1"),l=i(u),s=n("8Llf"),d=i(s),c=n("KUj2"),f=i(c),h=n("m1Gx"),_=i(h),p=n("9pan"),m=i(p);e.default={mixins:[d.default,f.default],components:{XTable:_.default,XPage:m.default},props:{group:{type:String,default:"bid"},bids:{type:Array,default:[]},yearMonth:{type:String,default:(0,o.default)(new Date).format("YYYY-MM")}},data:function(){return{data:[]}},watch:{bids:function(t){this.pageIndex=1,this.init_data()},group:function(t){this.pageIndex=1,this.init_data()},yearMonth:function(t){this.pageIndex=1,this.init_data()}},mounted:function(){this.init_data()},methods:{init_data:function(){var t=this;this.showLoading(),this.$rest(this.data_uri).get().success(function(e){t.data=e,t.loadFinished()})},loadFinished:function(){var t=this,e=this.data;e&&e.length>0&&e.push({column_total:!0}),setTimeout(function(){t.hideLoading()},300)},getTotal:function(t){var e=this.data,n=0;return e&&e.length>0&&(e.forEach(function(e){e[t]&&(n+=Number(e[t]))}),u._.isNumber(e[e.length-2][t])||(n=parseFloat(n).toFixed(2))),n}},computed:{tableHeight:function(){return(window.innerHeight||document.innerHeight)-(46+this.headerHeight)},accounts:function(){return this.$store.state.gvars.accounts||[]},tally_types:function(){return this.$store.state.gvars.tally_types||[]},tally_helps:function(){return this.$store.state.gvars.tally_helps||[]},columns:function(){var t=this,e=[],n={};"aa_id"==this.group?n={title:"账户",key:"aa_id",render:function(e,n){if(n.row.column_total)return"合计";var i=t.accounts.find(function(t){return t.aa_id===n.row.aa_id}),a="未指定";return i&&(a=i.name),e("span",a)}}:"cate"==this.group?n={title:"大类",key:"cate",render:function(t,e){return e.row.column_total?"合计":t("span",{1:"收入",2:"支出",3:"转账",4:"应收",5:"应付"}[e.row.cate]||"未指定")}}:"tt_id"==this.group?n={title:"小类",key:"tt_id",render:function(e,n){if(n.row.column_total)return"合计";var i=t.tally_types.find(function(t){return t.tt_id===n.row.tt_id}),a="未指定";return i&&(a=i.name),e("span",a)}}:"client_th_id"==this.group?n={title:"往来单位",key:"client_th_id",render:function(e,n){if(n.row.column_total)return"合计";var i=t.tally_helps.find(function(t){return t.th_id===n.row.client_th_id}),a="未指定";return i&&(a=i.name),e("span",a)}}:"item_th_id"==this.group?n={title:"项目",key:"item_th_id",render:function(e,n){if(n.row.column_total)return"合计";var i=t.tally_helps.find(function(t){return t.th_id===n.row.item_th_id}),a="未指定";return i&&(a=i.name),e("span",a)}}:"employee_th_id"==this.group&&(n={title:"人员",key:"employee_th_id",render:function(e,n){if(n.row.column_total)return"合计";var i=t.tally_helps.find(function(t){return t.th_id===n.row.employee_th_id}),a="未指定";return i&&(a=i.name),e("span",a)}});var i={title:"收入",key:"income",render:function(e,n){return n.row.column_total?e("span",{class:"text-danger"},"+"+t.getTotal("income")):n.row.income}},a={title:"支出",key:"payout",render:function(e,n){return n.row.column_total?e("span",{class:"text-danger"},"-"+t.getTotal("payout")):n.row.payout}};return e.push(n,i,a),e},data_uri:function(){var t=this.group,e=this.yearMonth+"-01",n=this.yearMonth+"-"+(0,o.default)(this.yearMonth).daysInMonth(),i="";return this.bids.length>0&&(i=l.default.sprintf("&bid=[In,%s]",this.bids.join(","))),l.default.sprintf("%s?group=%s&int_day=[Between,%s,%s]%s","tallys/do_stats",t,e,n,i)}}}},FF49:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n("MVMM"),r=(i(a),n("6ROu")),o=i(r),u=n("TVG1"),l=i(u),s=n("8Llf"),d=i(s),c=n("KUj2"),f=i(c),h=n("m1Gx"),_=i(h),p=n("9pan"),m=i(p);e.default={mixins:[d.default,f.default],components:{XTable:_.default,XPage:m.default},props:{group:{type:String,default:"bid"},bids:{type:Array,default:[]},yearMonth:{type:String,default:(0,o.default)(new Date).format("YYYY-MM")}},data:function(){return{data:[]}},watch:{bids:function(t){this.pageIndex=1,this.init_data()},group:function(t){this.pageIndex=1,this.init_data()},yearMonth:function(t){this.pageIndex=1,this.init_data()}},mounted:function(){this.init_data()},methods:{init_data:function(){var t=this;this.showLoading(),this.$rest(this.data_uri).get().success(function(e){t.data=e,t.loadFinished()})},loadFinished:function(){var t=this,e=this.data;e&&e.length>0&&e.push({column_total:!0}),setTimeout(function(){t.hideLoading()},300)},getTotal:function(t){var e=this.data,n=0;return e&&e.length>0&&(e.forEach(function(e){e[t]&&(n+=Number(e[t]))}),u._.isNumber(e[e.length-2][t])||(n=parseFloat(n).toFixed(2))),n}},computed:{tableHeight:function(){return(window.innerHeight||document.innerHeight)-(46+this.headerHeight)},accounts:function(){return this.$store.state.gvars.accounts||[]},tally_types:function(){return this.$store.state.gvars.tally_types||[]},tally_helps:function(){return this.$store.state.gvars.tally_helps||[]},columns:function(){var t=this,e=[],n={};"aa_id"==this.group?n={title:"账户",key:"aa_id",render:function(e,n){if(n.row.column_total)return"合计";var i=t.accounts.find(function(t){return t.aa_id===n.row.aa_id}),a="未指定";return i&&(a=i.name),e("span",a)}}:"cate"==this.group?n={title:"大类",key:"cate",render:function(t,e){return e.row.column_total?"合计":t("span",{1:"收入",2:"支出",3:"转账",4:"应收",5:"应付"}[e.row.cate]||"未指定")}}:"tt_id"==this.group?n={title:"小类",key:"tt_id",render:function(e,n){if(n.row.column_total)return"合计";var i=t.tally_types.find(function(t){return t.tt_id===n.row.tt_id}),a="未指定";return i&&(a=i.name),e("span",a)}}:"client_th_id"==this.group?n={title:"往来单位",key:"client_th_id",render:function(e,n){if(n.row.column_total)return"合计";var i=t.tally_helps.find(function(t){return t.th_id===n.row.client_th_id}),a="未指定";return i&&(a=i.name),e("span",a)}}:"item_th_id"==this.group?n={title:"项目",key:"item_th_id",render:function(e,n){if(n.row.column_total)return"合计";var i=t.tally_helps.find(function(t){return t.th_id===n.row.item_th_id}),a="未指定";return i&&(a=i.name),e("span",a)}}:"employee_th_id"==this.group&&(n={title:"人员",key:"employee_th_id",render:function(e,n){if(n.row.column_total)return"合计";var i=t.tally_helps.find(function(t){return t.th_id===n.row.employee_th_id}),a="未指定";return i&&(a=i.name),e("span",a)}});var i={title:"收入",key:"income",render:function(e,n){return n.row.column_total?e("span",{class:"text-danger"},"+"+t.getTotal("income")):n.row.income}},a={title:"支出",key:"payout",render:function(e,n){return n.row.column_total?e("span",{class:"text-danger"},"-"+t.getTotal("payout")):n.row.payout}};return e.push(n,i,a),e},data_uri:function(){var t=this.group,e=this.yearMonth+"-01",n=this.yearMonth+"-"+(0,o.default)(this.yearMonth).daysInMonth(),i="";return this.bids.length>0&&(i=l.default.sprintf("&bid=[In,%s]",this.bids.join(","))),l.default.sprintf("%s?group=%s&int_day=[Between,%s,%s]%s","tallys/do_stats",t,e,n,i)}}}},Hvbv:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n("S9nr"),r=i(a),o=n("o+C2"),u=i(o),l=n("+6Lo"),s=i(l),d=n("c+rr"),c=i(d),f=n("EBxd"),h=i(f);e.default={mixins:[s.default],components:{XTable:c.default,Datetime:r.default,PopupPicker:u.default,SelectBranch:h.default},data:function(){return{popupShow:!1,filter:["aa_id"],filterList:[{name:"按账户统计",value:"aa_id"},{name:"按大类统计",value:"cate"},{name:"按小类统计",value:"tt_id"},{name:"按往来单位统计",value:"client_th_id"},{name:"按项目统计",value:"item_th_id"},{name:"按人员统计",value:"employee_th_id"}]}}}},JU6C:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bg-white height-full"},[n("div",{staticClass:"x-header"},[n("span",{staticClass:"icon icon-ios-arrow-left",on:{click:t.preMonth}}),t._v(" "),n("datetime",{attrs:{format:"YYYY-MM","max-year":t.maxYear},model:{value:t.yearMonth,callback:function(e){t.yearMonth=e},expression:"yearMonth"}},[n("span",{staticClass:"title"},[t._v(t._s(t.title))])]),t._v(" "),n("span",{staticClass:"icon icon-ios-arrow-right",on:{click:t.nextMonth}}),t._v(" "),n("div",{staticClass:"x-header-filter",on:{click:function(e){t.popupShow=!0}}},[n("i",{staticClass:"icon icon-funnel"}),t._v("\n\t\t\t"+t._s(t.$refs.filter?t.$refs.filter.getNameValues():"按账户统计")+"\n\t\t")])],1),t._v(" "),n("select-branch",{model:{value:t.bids,callback:function(e){t.bids=e},expression:"bids"}}),t._v(" "),n("x-table",{attrs:{"year-month":t.yearMonth,bids:t.bids,group:t.filter[0]}}),t._v(" "),n("popup-picker",{ref:"filter",attrs:{show:t.popupShow,"show-cell":!1,columns:1,data:t.filterList},on:{"update:show":function(e){t.popupShow=e}},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})],1)},a=[],r={render:i,staticRenderFns:a};e.a=r},LuuH:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("x-table",{attrs:{height:t.tableHeight,width:"100%",border:!1,columns:t.columns,data:t.data}})],1)},a=[],r={render:i,staticRenderFns:a};e.a=r},"c+rr":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("6v+Q");n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,function(){return i[t]})}(a);var r=n("FF49"),o=n.n(r),u=n("LuuH"),l=n("vSla"),s=l(o.a,u.a,!1,null,null,null);e.default=s.exports},eZZD:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("Hvbv");n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,function(){return i[t]})}(a);var r=n("iMDQ"),o=n.n(r),u=n("JU6C"),l=n("vSla"),s=l(o.a,u.a,!1,null,null,null);e.default=s.exports},iMDQ:function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n("S9nr"),r=i(a),o=n("o+C2"),u=i(o),l=n("+6Lo"),s=i(l),d=n("c+rr"),c=i(d),f=n("EBxd"),h=i(f);e.default={mixins:[s.default],components:{XTable:c.default,Datetime:r.default,PopupPicker:u.default,SelectBranch:h.default},data:function(){return{popupShow:!1,filter:["aa_id"],filterList:[{name:"按账户统计",value:"aa_id"},{name:"按大类统计",value:"cate"},{name:"按小类统计",value:"tt_id"},{name:"按往来单位统计",value:"client_th_id"},{name:"按项目统计",value:"item_th_id"},{name:"按人员统计",value:"employee_th_id"}]}}}}});
//# sourceMappingURL=25.d8b35c31d3dbdfc69e0e.js.map