webpackJsonp([30],{"31L6":function(t,n,e){"use strict";function i(t){e("IHAN")}Object.defineProperty(n,"__esModule",{value:!0});var o=e("uoXk");e.n(o);for(var s in o)"default"!==s&&function(t){e.d(n,t,function(){return o[t]})}(s);var a=e("NmZx"),c=e.n(a),l=e("iaMO"),r=e("vSla"),u=i,f=r(c.a,l.a,!1,u,null,null);n.default=f.exports},E3ZX:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("TVG1"),o=function(t){return t&&t.__esModule?t:{default:t}}(i);n.default={data:function(){return{recording:!1,time:0,time_out:null}},mounted:function(){},methods:{closeRecordMask:function(){this.recording||(this.showRecord=!1)},record:function(){var t=this;this.recording=!this.recording,this.recording?this.startRecord().then(function(){t.time_out=setTimeout(t.timeCounting,1e3)}):(this.stopRecord().then(function(n){var e={file_type:"voice",file_url:n,duration:o.default.copy(t.time),_is_wx_file:!0};t.info.homework_attachment.push(e),t.resetTime()}),this.showRecord=!1)},resetTime:function(){this.time=0,this.time_out&&window.clearTimeout(this.time_out),this.setRecordTime&&window.clearTimeout(this.setRecordTime)},timeCounting:function(){this.time=0,this.setRecordTime()},setRecordTime:function(){this.time<60&&this.recording&&(this.time++,window.setTimeout(this.setRecordTime,1e3))}},computed:{recordTime:function(){var t=this.time,n="0:"+(t<10?"0"+t:t);return 60==t&&(n="1:00"),n}}}},IHAN:function(t,n,e){var i=e("qbH9");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);e("FIqI")("10665beb",i,!0,{})},NmZx:function(t,n,e){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("3cXf"),s=i(o),a=e("TVG1"),c=i(a),l=e("6ROu"),r=i(l),u=e("E3ZX"),f=i(u),d=e("8Llf"),h=i(d),m=e("/AUM"),_=i(m),v=e("+CBI"),p=i(v),g=e("JlEs"),w=i(g),k=e("gP80"),b=i(k),x=e("gpPJ"),y=i(x),C=e("CKVb"),I=i(C),M=e("S9nr"),X=i(M),R=e("fvyU"),T=i(R),D=e("RAwi"),O=i(D),Y=e("IXui"),$=i(Y);n.default={mixins:[f.default,h.default,_.default],components:{Cell:y.default,Group:I.default,XInput:T.default,XButton:$.default,iSwitch:p.default,Datetime:X.default,XTextarea:O.default,SmallVoice:w.default,SelectClass:b.default},data:function(){return{showRecord:!1,info:{lid:0,bid:0,sids:[],sid:0,cid:0,eid:0,remark:"",is_push:!0,deadline:(0,r.default)(new Date).add(7,"days").format("YYYY-MM-DD"),content:"",homework_attachment:[],lesson_type:1,_class_name:""},startDate:(0,r.default)(new Date).format("YYYY-MM-DD")}},methods:{file_list:function(t){var n=[[],this.info.homework_attachment],e=n[0],i=n[1];return i.length>0&&(e=i.filter(function(n){return n.file_type==t})),e},delItem:function(t){var n=this.info.homework_attachment.indexOf(t);n>-1&&this.info.homework_attachment.splice(n,1)},chooseWXImage:function(){var t=this,n=9-this.file_list("image").length;this.chooseImage(n,!1).then(function(n){n.length&&n.forEach(function(n){var e={file_type:"image",file_url:n};t.isIOS&&t.getlocalImageData(t.images.localId[n]).then(function(t){e.file_url=t}),t.info.homework_attachment.push(e)})})},ok:function(){var t=this;return this.info.eid=this.eid$,0==this.info.cid?void this.toast("请选择作业班级","warn"):/^\s*$/.test(this.info.content)?void this.toast("请输入作业内容","warn"):void(this.info.homework_attachment.length?this.getWXFile(this.info.homework_attachment).then(function(n){t.post(n)},function(t){alert((0,s.default)(t))}):this.post())},post:function(t){var n=this;t=t||[];var e=c.default.copy(this.info);e.homework_attachment=t,e.deadline=c.default.format_int_day(e.deadline),this.$rest("homework_tasks").post(e).success(function(t){n.toast("布置成功","success"),setTimeout(function(){n.$router.go(-1)},1e3)}).error(function(t){n.toast(t.body.message||"布置失败！","warn")})},chooseObject:function(){this.$refs.object.show()},setObject:function(t){this.info.lid=t.lid,this.info.lesson_type=0,this.info.bid=t.bid}}}},iaMO:function(t,n,e){"use strict";var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("group",[e("select-class",{on:{"on-selected":t.setObject},model:{value:t.info.cid,callback:function(n){t.$set(t.info,"cid",n)},expression:"info.cid"}}),t._v(" "),e("datetime",{attrs:{title:"截止日期","start-date":t.startDate},model:{value:t.info.deadline,callback:function(n){t.$set(t.info,"deadline",n)},expression:"info.deadline"}}),t._v(" "),e("x-textarea",{attrs:{placeholder:"请输入作业内容"},model:{value:t.info.content,callback:function(n){t.$set(t.info,"content",n)},expression:"info.content"}}),t._v(" "),t.file_list("image").length?e("div",{staticClass:"input-file-container"},[e("div",{staticClass:"image-list"},t._l(t.file_list("image"),function(n){return e("div",{staticClass:"image-item",style:{background:"url("+n.file_url+")"}},[e("div",{staticClass:"image-close",on:{click:function(e){t.delItem(n)}}},[t._v("X")])])}))]):t._e(),t._v(" "),t.file_list("voice").length?e("div",{staticClass:"record-container"},t._l(t.file_list("voice"),function(n,i){return e("div",{staticClass:"voice-item",on:{click:function(e){t.currentItem=n}}},[e("div",{staticClass:"image-close",on:{click:function(e){e.stopPropagation(),t.delItem(n)}}},[t._v("X")]),t._v(" "),e("small-voice",{attrs:{file:n,active:t.currentItem==n}})],1)})):t._e(),t._v(" "),e("div",{staticClass:"bg-white pd-10"},[e("span",{staticClass:"text-desc text-small mg-r-10",on:{click:function(n){t.showRecord=!0}}},[e("i",{staticClass:"icon icon-mic-a"}),t._v("\n\t\t\t\t点击录音\n\t\t\t")]),t._v(" "),e("span",{staticClass:"text-desc text-small",on:{click:t.chooseWXImage}},[e("i",{staticClass:"icon icon-image"}),t._v("\n\t\t\t\t选择图片\n\t\t\t")])])],1),t._v(" "),e("group",[e("x-input",{attrs:{title:"备注",placeholder:"请输入备注","text-align":"right"},model:{value:t.info.remark,callback:function(n){t.$set(t.info,"remark",n)},expression:"info.remark"}}),t._v(" "),e("cell",{attrs:{title:"是否推送给学生"}},[e("i-switch",{model:{value:t.info.is_push,callback:function(n){t.$set(t.info,"is_push",n)},expression:"info.is_push"}})],1)],1),t._v(" "),e("div",{staticClass:"pd-10"},[e("x-button",{attrs:{type:"x-btn btn-bg-theme"},nativeOn:{click:function(n){return t.ok(n)}}},[t._v("提交")])],1),t._v(" "),t.showRecord?e("div",[e("div",{ref:"recordMask",staticClass:"record-mask",on:{click:t.closeRecordMask}}),t._v(" "),e("div",{staticClass:"recording-container"},[e("div",{staticClass:"record-time"},[t._v(t._s(t.recordTime))]),t._v(" "),e("span",{staticClass:"record-btn",class:t.recording?"active":"",on:{click:t.record}})])]):t._e()],1)},o=[],s={render:i,staticRenderFns:o};n.a=s},qbH9:function(t,n,e){n=t.exports=e("UTlt")(!0),n.push([t.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","",{version:3,sources:[],names:[],mappings:"",file:"add.vue",sourceRoot:""}])},uoXk:function(t,n,e){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("3cXf"),s=i(o),a=e("TVG1"),c=i(a),l=e("6ROu"),r=i(l),u=e("E3ZX"),f=i(u),d=e("8Llf"),h=i(d),m=e("/AUM"),_=i(m),v=e("+CBI"),p=i(v),g=e("JlEs"),w=i(g),k=e("gP80"),b=i(k),x=e("gpPJ"),y=i(x),C=e("CKVb"),I=i(C),M=e("S9nr"),X=i(M),R=e("fvyU"),T=i(R),D=e("RAwi"),O=i(D),Y=e("IXui"),$=i(Y);n.default={mixins:[f.default,h.default,_.default],components:{Cell:y.default,Group:I.default,XInput:T.default,XButton:$.default,iSwitch:p.default,Datetime:X.default,XTextarea:O.default,SmallVoice:w.default,SelectClass:b.default},data:function(){return{showRecord:!1,info:{lid:0,bid:0,sids:[],sid:0,cid:0,eid:0,remark:"",is_push:!0,deadline:(0,r.default)(new Date).add(7,"days").format("YYYY-MM-DD"),content:"",homework_attachment:[],lesson_type:1,_class_name:""},startDate:(0,r.default)(new Date).format("YYYY-MM-DD")}},methods:{file_list:function(t){var n=[[],this.info.homework_attachment],e=n[0],i=n[1];return i.length>0&&(e=i.filter(function(n){return n.file_type==t})),e},delItem:function(t){var n=this.info.homework_attachment.indexOf(t);n>-1&&this.info.homework_attachment.splice(n,1)},chooseWXImage:function(){var t=this,n=9-this.file_list("image").length;this.chooseImage(n,!1).then(function(n){n.length&&n.forEach(function(n){var e={file_type:"image",file_url:n};t.isIOS&&t.getlocalImageData(t.images.localId[n]).then(function(t){e.file_url=t}),t.info.homework_attachment.push(e)})})},ok:function(){var t=this;return this.info.eid=this.eid$,0==this.info.cid?void this.toast("请选择作业班级","warn"):/^\s*$/.test(this.info.content)?void this.toast("请输入作业内容","warn"):void(this.info.homework_attachment.length?this.getWXFile(this.info.homework_attachment).then(function(n){t.post(n)},function(t){alert((0,s.default)(t))}):this.post())},post:function(t){var n=this;t=t||[];var e=c.default.copy(this.info);e.homework_attachment=t,e.deadline=c.default.format_int_day(e.deadline),this.$rest("homework_tasks").post(e).success(function(t){n.toast("布置成功","success"),setTimeout(function(){n.$router.go(-1)},1e3)}).error(function(t){n.toast(t.body.message||"布置失败！","warn")})},chooseObject:function(){this.$refs.object.show()},setObject:function(t){this.info.lid=t.lid,this.info.lesson_type=0,this.info.bid=t.bid}}}}});
//# sourceMappingURL=30.8491c38c50d2b9c03914.js.map