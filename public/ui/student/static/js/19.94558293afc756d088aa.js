webpackJsonp([19],{"91bn":function(t,n,e){n=t.exports=e("UTlt")(!0),n.push([t.i,"\n.record-mask {\n  width: 100%;\n  height: 100%;\n  position: fixed;\n  z-index: 9;\n  left: 0;\n  top: 0;\n  background: rgba(0, 0, 0, 0.3);\n}\n.recording-container {\n  height: 240px;\n  width: 100%;\n  background: #fff;\n  position: fixed;\n  left: 0;\n  bottom: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 10;\n  flex-direction: column;\n  color: #323232;\n}\n.recording-container .record-time {\n  font-size: 16px;\n}\n.recording-container .record-btn {\n  width: 100px;\n  height: 100px;\n  background: #f5f5f5;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin: 20px 0 15px 0;\n  position: relative;\n  border-radius: 50%;\n  border: 1px solid #dddddd;\n}\n.recording-container .record-btn:after {\n  content: '';\n  width: 70px;\n  height: 70px;\n  background-color: red;\n  border-radius: 50%;\n  position: absolute;\n  left: 15px;\n  top: 15px;\n}\n.recording-container .record-btn.active:after {\n  width: 50px;\n  height: 50px;\n  border-radius: 6px;\n  background-color: #38C4FF;\n  left: 25px;\n  top: 25px;\n}\n.full-fixed-page {\n  width: 100%;\n  height: 100%;\n  position: fixed;\n  left: 0;\n  top: 0;\n}\n.content-input {\n  padding: 10px;\n  border-bottom: 1px solid #EEEEEE;\n}\n.content-input textarea {\n  resize: none;\n  padding: 3px;\n  width: 100%;\n  box-sizing: border-box;\n  height: 140px;\n  border: none;\n  outline: none;\n  font-size: 14px;\n}\n.image-list,\n.record-container {\n  width: 100%;\n  background-size: cover;\n  padding: 10px 10px;\n  overflow: hidden;\n  border-bottom: 1px solid #EEEEEE;\n}\n.image-list .image-item,\n.record-container .image-item {\n  width: 65px;\n  height: 65px;\n  background-size: cover !important;\n  display: inline-block;\n  position: relative;\n  border-radius: 5px;\n  margin-right: 10px;\n  margin-bottom: 10px;\n  border: solid 1px #e8e8e8 !important;\n  float: left;\n}\n.image-list .image-item.space > div,\n.record-container .image-item.space > div {\n  height: 100%;\n  text-align: center;\n  color: #999999;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  font-size: 14px;\n}\n.voice-item {\n  border: 1px solid #dddddd;\n  display: inline-block;\n  position: relative;\n  padding: 5px 30px 5px 10px;\n  border-radius: 5px;\n  margin-right: 15px;\n  margin-bottom: 10px;\n}\n.image-close {\n  position: absolute;\n  display: inline-block;\n  right: -6px;\n  top: -6px;\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  line-height: 20px;\n  border-radius: 12px;\n  background-color: #FF5053;\n  color: #f3f3f3;\n  border: solid 1px #FF5053;\n  font-size: 9px;\n  font-weight: 200;\n  z-index: 1;\n  box-sizing: border-box;\n}\n.footer {\n  margin-top: 20px;\n}\n","",{version:3,sources:["/Users/payhon/Project/x360p/src/neza_student_mobile/src/views/home/homework/submit.vue"],names:[],mappings:";AACA;EACE,YAAY;EACZ,aAAa;EACb,gBAAgB;EAChB,WAAW;EACX,QAAQ;EACR,OAAO;EACP,+BAA+B;CAChC;AACD;EACE,cAAc;EACd,YAAY;EACZ,iBAAiB;EACjB,gBAAgB;EAChB,QAAQ;EACR,UAAU;EACV,cAAc;EACd,wBAAwB;EACxB,oBAAoB;EACpB,YAAY;EACZ,uBAAuB;EACvB,eAAe;CAChB;AACD;EACE,gBAAgB;CACjB;AACD;EACE,aAAa;EACb,cAAc;EACd,oBAAoB;EACpB,cAAc;EACd,wBAAwB;EACxB,oBAAoB;EACpB,sBAAsB;EACtB,mBAAmB;EACnB,mBAAmB;EACnB,0BAA0B;CAC3B;AACD;EACE,YAAY;EACZ,YAAY;EACZ,aAAa;EACb,sBAAsB;EACtB,mBAAmB;EACnB,mBAAmB;EACnB,WAAW;EACX,UAAU;CACX;AACD;EACE,YAAY;EACZ,aAAa;EACb,mBAAmB;EACnB,0BAA0B;EAC1B,WAAW;EACX,UAAU;CACX;AACD;EACE,YAAY;EACZ,aAAa;EACb,gBAAgB;EAChB,QAAQ;EACR,OAAO;CACR;AACD;EACE,cAAc;EACd,iCAAiC;CAClC;AACD;EACE,aAAa;EACb,aAAa;EACb,YAAY;EACZ,uBAAuB;EACvB,cAAc;EACd,aAAa;EACb,cAAc;EACd,gBAAgB;CACjB;AACD;;EAEE,YAAY;EACZ,uBAAuB;EACvB,mBAAmB;EACnB,iBAAiB;EACjB,iCAAiC;CAClC;AACD;;EAEE,YAAY;EACZ,aAAa;EACb,kCAAkC;EAClC,sBAAsB;EACtB,mBAAmB;EACnB,mBAAmB;EACnB,mBAAmB;EACnB,oBAAoB;EACpB,qCAAqC;EACrC,YAAY;CACb;AACD;;EAEE,aAAa;EACb,mBAAmB;EACnB,eAAe;EACf,cAAc;EACd,uBAAuB;EACvB,oBAAoB;EACpB,wBAAwB;EACxB,gBAAgB;CACjB;AACD;EACE,0BAA0B;EAC1B,sBAAsB;EACtB,mBAAmB;EACnB,2BAA2B;EAC3B,mBAAmB;EACnB,mBAAmB;EACnB,oBAAoB;CACrB;AACD;EACE,mBAAmB;EACnB,sBAAsB;EACtB,YAAY;EACZ,UAAU;EACV,YAAY;EACZ,aAAa;EACb,mBAAmB;EACnB,kBAAkB;EAClB,oBAAoB;EACpB,0BAA0B;EAC1B,eAAe;EACf,0BAA0B;EAC1B,eAAe;EACf,iBAAiB;EACjB,WAAW;EACX,uBAAuB;CACxB;AACD;EACE,iBAAiB;CAClB",file:"submit.vue",sourcesContent:["\n.record-mask {\n  width: 100%;\n  height: 100%;\n  position: fixed;\n  z-index: 9;\n  left: 0;\n  top: 0;\n  background: rgba(0, 0, 0, 0.3);\n}\n.recording-container {\n  height: 240px;\n  width: 100%;\n  background: #fff;\n  position: fixed;\n  left: 0;\n  bottom: 0;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 10;\n  flex-direction: column;\n  color: #323232;\n}\n.recording-container .record-time {\n  font-size: 16px;\n}\n.recording-container .record-btn {\n  width: 100px;\n  height: 100px;\n  background: #f5f5f5;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin: 20px 0 15px 0;\n  position: relative;\n  border-radius: 50%;\n  border: 1px solid #dddddd;\n}\n.recording-container .record-btn:after {\n  content: '';\n  width: 70px;\n  height: 70px;\n  background-color: red;\n  border-radius: 50%;\n  position: absolute;\n  left: 15px;\n  top: 15px;\n}\n.recording-container .record-btn.active:after {\n  width: 50px;\n  height: 50px;\n  border-radius: 6px;\n  background-color: #38C4FF;\n  left: 25px;\n  top: 25px;\n}\n.full-fixed-page {\n  width: 100%;\n  height: 100%;\n  position: fixed;\n  left: 0;\n  top: 0;\n}\n.content-input {\n  padding: 10px;\n  border-bottom: 1px solid #EEEEEE;\n}\n.content-input textarea {\n  resize: none;\n  padding: 3px;\n  width: 100%;\n  box-sizing: border-box;\n  height: 140px;\n  border: none;\n  outline: none;\n  font-size: 14px;\n}\n.image-list,\n.record-container {\n  width: 100%;\n  background-size: cover;\n  padding: 10px 10px;\n  overflow: hidden;\n  border-bottom: 1px solid #EEEEEE;\n}\n.image-list .image-item,\n.record-container .image-item {\n  width: 65px;\n  height: 65px;\n  background-size: cover !important;\n  display: inline-block;\n  position: relative;\n  border-radius: 5px;\n  margin-right: 10px;\n  margin-bottom: 10px;\n  border: solid 1px #e8e8e8 !important;\n  float: left;\n}\n.image-list .image-item.space > div,\n.record-container .image-item.space > div {\n  height: 100%;\n  text-align: center;\n  color: #999999;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  font-size: 14px;\n}\n.voice-item {\n  border: 1px solid #dddddd;\n  display: inline-block;\n  position: relative;\n  padding: 5px 30px 5px 10px;\n  border-radius: 5px;\n  margin-right: 15px;\n  margin-bottom: 10px;\n}\n.image-close {\n  position: absolute;\n  display: inline-block;\n  right: -6px;\n  top: -6px;\n  width: 20px;\n  height: 20px;\n  text-align: center;\n  line-height: 20px;\n  border-radius: 12px;\n  background-color: #FF5053;\n  color: #f3f3f3;\n  border: solid 1px #FF5053;\n  font-size: 9px;\n  font-weight: 200;\n  z-index: 1;\n  box-sizing: border-box;\n}\n.footer {\n  margin-top: 20px;\n}\n"],sourceRoot:""}])},E3ZX:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("TVG1"),o=function(t){return t&&t.__esModule?t:{default:t}}(i);n.default={data:function(){return{recording:!1,time:0,time_out:null}},mounted:function(){},methods:{closeRecordMask:function(){this.recording||(this.showRecord=!1)},record:function(){var t=this;this.recording=!this.recording,this.recording?this.startRecord().then(function(){t.time_out=setTimeout(t.timeCounting,1e3)}):(this.stopRecord().then(function(n){var e={file_type:"voice",file_url:n,duration:o.default.copy(t.time),_is_wx_file:!0};console.log(e),t.info.homework_attachment.push(e),t.resetTime()}),this.showRecord=!1)},resetTime:function(){this.time=0,this.time_out&&window.clearTimeout(this.time_out),this.setRecordTime&&window.clearTimeout(this.setRecordTime)},timeCounting:function(){this.time=0,this.setRecordTime()},setRecordTime:function(){this.time<60&&this.recording&&(this.time++,window.setTimeout(this.setRecordTime,1e3))}},computed:{recordTime:function(){var t=this.time,n="0:"+(t<10?"0"+t:t);return 60==t&&(n="1:00"),n}}}},gkpE:function(t,n,e){"use strict";function i(t){e("nQC2")}Object.defineProperty(n,"__esModule",{value:!0});var o=e("luEN");e.n(o);for(var r in o)"default"!==r&&function(t){e.d(n,t,function(){return o[t]})}(r);var a=e("le/p"),s=e.n(a),c=e("oGNl"),d=e("vSla"),l=i,A=d(s.a,c.a,!1,l,null,null);n.default=A.exports},"le/p":function(t,n,e){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("rVsN"),r=i(o),a=e("TVG1"),s=i(a),c=e("/AUM"),d=i(c),l=e("8Llf"),A=i(l),u=e("E3ZX"),f=i(u),p=e("zhFk"),m=i(p),h=e("JlEs"),g=i(h),C=e("IXui"),x=i(C),B=e("CKVb"),E=i(B),b=e("gpPJ"),v=i(b),_=e("RAwi"),w=i(_),k=e("5CvF"),y=i(k),z=e("4rfY"),F=i(z),Y=e("f/tg"),I=i(Y),R=e("cTn1"),X=i(R);n.default={mixins:[f.default,A.default,d.default],components:{Cell:v.default,Group:E.default,Rater:I.default,Popup:X.default,XButton:x.default,Flexbox:y.default,SmallVoice:g.default,XTextarea:w.default,FlexboxItem:F.default,MyRater:m.default},data:function(){return{showRecord:!1,currentItem:{},id:this.$route.params.id,map_star_text:{1:"简单",2:"一般",3:"中等",4:"困难",5:"史诗"},info:{ht_id:0,content:"",sid:0,star:0,homework_attachment:[]}}},methods:{file_list:function(t){var n=[[],this.info.homework_attachment],e=n[0],i=n[1];return i.length>0&&(e=i.filter(function(n){return n.file_type==t})),e},delItem:function(t){var n=this.info.homework_attachment.indexOf(t);n>-1&&this.info.homework_attachment.splice(n,1)},chooseWXImage:function(){var t=this,n=9-this.file_list("image").length;this.chooseImage(n,!1).then(function(n){n.length&&n.forEach(function(n){var e={file_type:"image",file_url:n};t.isIOS&&t.getlocalImageData(t.images.localId[n]).then(function(t){e.file_url=t}),t.info.homework_attachment.push(e)})})},submit:function(){var t=this,n=this.info.homework_attachment;if(this.info.ht_id=this.id,/^\s*$/.test(this.info.content))return void this.toast("请输入作业内容","warn");n.length?this.getWXFile(n).then(function(n){t.post(n)},function(t){alert(t)}):this.post()},post:function(t){var n=this;t=t||[];var e=s.default.copy(this.info);e.homework_attachment=t,e.sid=this.$store.state.user.info.default_sid,this.$rest("homework_tasks/"+this.id+"/homework_complete").post(e).success(function(t){n.toast("提交成功","success"),setTimeout(function(){n.$router.go(-1)},1e3)}).error(function(t){n.toast(t.body.message||"提交失败","warn")})},getWXFile:function(t){var n=[],e="",i=0,o=this;return t=t||[],new r.default(function(r,a){function s(){"image"==t[i].file_type?e="uploadSingleImage":"voice"==t[i].file_type&&(e="uploadVoice"),o[e](t[i].file_url).then(function(e){o.downloadWXFile(e,t[i].file_type).then(function(e){i++,n.push(e.data[0]),i<t.length?s():r(n)},function(t){a(t)})})}t.length&&s()})}},computed:{enable_homework_star:function(){var t=0;return this.$store.state.gvars.configs&&this.$store.state.gvars.configs.params&&(t=this.$store.state.gvars.configs.params.service.enable_homework_star),t}}}},luEN:function(t,n,e){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("rVsN"),r=i(o),a=e("TVG1"),s=i(a),c=e("/AUM"),d=i(c),l=e("8Llf"),A=i(l),u=e("E3ZX"),f=i(u),p=e("zhFk"),m=i(p),h=e("JlEs"),g=i(h),C=e("IXui"),x=i(C),B=e("CKVb"),E=i(B),b=e("gpPJ"),v=i(b),_=e("RAwi"),w=i(_),k=e("5CvF"),y=i(k),z=e("4rfY"),F=i(z),Y=e("f/tg"),I=i(Y),R=e("cTn1"),X=i(R);n.default={mixins:[f.default,A.default,d.default],components:{Cell:v.default,Group:E.default,Rater:I.default,Popup:X.default,XButton:x.default,Flexbox:y.default,SmallVoice:g.default,XTextarea:w.default,FlexboxItem:F.default,MyRater:m.default},data:function(){return{showRecord:!1,currentItem:{},id:this.$route.params.id,map_star_text:{1:"简单",2:"一般",3:"中等",4:"困难",5:"史诗"},info:{ht_id:0,content:"",sid:0,star:0,homework_attachment:[]}}},methods:{file_list:function(t){var n=[[],this.info.homework_attachment],e=n[0],i=n[1];return i.length>0&&(e=i.filter(function(n){return n.file_type==t})),e},delItem:function(t){var n=this.info.homework_attachment.indexOf(t);n>-1&&this.info.homework_attachment.splice(n,1)},chooseWXImage:function(){var t=this,n=9-this.file_list("image").length;this.chooseImage(n,!1).then(function(n){n.length&&n.forEach(function(n){var e={file_type:"image",file_url:n};t.isIOS&&t.getlocalImageData(t.images.localId[n]).then(function(t){e.file_url=t}),t.info.homework_attachment.push(e)})})},submit:function(){var t=this,n=this.info.homework_attachment;if(this.info.ht_id=this.id,/^\s*$/.test(this.info.content))return void this.toast("请输入作业内容","warn");n.length?this.getWXFile(n).then(function(n){t.post(n)},function(t){alert(t)}):this.post()},post:function(t){var n=this;t=t||[];var e=s.default.copy(this.info);e.homework_attachment=t,e.sid=this.$store.state.user.info.default_sid,this.$rest("homework_tasks/"+this.id+"/homework_complete").post(e).success(function(t){n.toast("提交成功","success"),setTimeout(function(){n.$router.go(-1)},1e3)}).error(function(t){n.toast(t.body.message||"提交失败","warn")})},getWXFile:function(t){var n=[],e="",i=0,o=this;return t=t||[],new r.default(function(r,a){function s(){"image"==t[i].file_type?e="uploadSingleImage":"voice"==t[i].file_type&&(e="uploadVoice"),o[e](t[i].file_url).then(function(e){o.downloadWXFile(e,t[i].file_type).then(function(e){i++,n.push(e.data[0]),i<t.length?s():r(n)},function(t){a(t)})})}t.length&&s()})}},computed:{enable_homework_star:function(){var t=0;return this.$store.state.gvars.configs&&this.$store.state.gvars.configs.params&&(t=this.$store.state.gvars.configs.params.service.enable_homework_star),t}}}},nQC2:function(t,n,e){var i=e("91bn");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);e("FIqI")("306cbf40",i,!0,{})},oGNl:function(t,n,e){"use strict";var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"bg-white full-fixed-page",style:{paddingTop:t.headerHeight+"px"}},[t.enable_homework_star?e("div",{staticClass:"level-star text-center pd-10 b-b-1"},[e("my-rater",{attrs:{"font-size":30,margin:15},model:{value:t.info.star,callback:function(n){t.$set(t.info,"star",n)},expression:"info.star"}}),t._v(" "),e("p",[e("small",{staticClass:"text-disable"},[t._v("\n\t\t\t\t作业星级: "+t._s(t.map_star_text[t.info.star])+"\n\t\t\t")])])],1):t._e(),t._v(" "),e("div",{staticClass:"content-input"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.info.content,expression:"info.content"}],staticClass:"x-teaxtare",attrs:{placeholder:"请输入作业内容"},domProps:{value:t.info.content},on:{input:function(n){n.target.composing||t.$set(t.info,"content",n.target.value)}}}),t._v(" "),e("p",{staticClass:"text-right text-small",on:{click:function(n){t.showRecord=!0}}},[e("i",{staticClass:"icon icon-mic-a"}),t._v(" 点击录制语音")])]),t._v(" "),e("div",{staticClass:"input-file-container"},[e("div",{staticClass:"image-list"},[t._l(t.file_list("image"),function(n){return e("div",{staticClass:"image-item",style:{background:"url("+n.file_url+")"}},[e("div",{staticClass:"image-close",on:{click:function(e){t.delItem(n)}}},[t._v("X")])])}),t._v(" "),e("div",{staticClass:"image-item space",on:{click:t.chooseWXImage}},[t._m(0)])],2)]),t._v(" "),t.file_list("voice").length?e("div",{staticClass:"record-container"},t._l(t.file_list("voice"),function(n,i){return e("div",{staticClass:"voice-item",on:{click:function(e){t.currentItem=n}}},[e("div",{staticClass:"image-close",on:{click:function(e){e.stopPropagation(),t.delItem(n)}}},[t._v("X")]),t._v(" "),e("small-voice",{attrs:{file:n,active:t.currentItem==n}})],1)})):t._e(),t._v(" "),t.showRecord?e("div",[e("div",{ref:"recordMask",staticClass:"record-mask",on:{click:t.closeRecordMask}}),t._v(" "),e("div",{staticClass:"recording-container"},[e("div",{staticClass:"record-time"},[t._v(t._s(t.recordTime))]),t._v(" "),e("span",{staticClass:"record-btn",class:t.recording?"active":"",on:{click:t.record}})])]):t._e(),t._v(" "),e("div",{staticClass:"footer"},[e("x-button",{staticClass:"x-btn x-btn-md x-btn-circle btn-bg-theme",attrs:{type:"primary"},nativeOn:{click:function(n){return t.submit(n)}}},[t._v("提交")])],1)])},o=[function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("i",{staticClass:"icon icon-camera"}),t._v(" "),e("p",[t._v("照片")])])}],r={render:i,staticRenderFns:o};n.a=r}});
//# sourceMappingURL=19.94558293afc756d088aa.js.map