webpackJsonp([14],{"+wM7":function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n("+VlJ"),r=(a(i),n("VD+p")),o=a(r),s=n("TVG1"),u=a(s),d=n("8Llf"),l=a(d),f=n("KUj2"),c=a(f),h=n("m1Gx"),_=a(h);e.default={mixins:[l.default,c.default],components:{XTable:_.default},props:{bids:{type:Array,default:[]},group:{type:String,default:"from_did"},yearMonth:{type:String,default:(0,o.default)(new Date).format("YYYY-MM")}},data:function(){return{data:[]}},watch:{bids:function(t){this.pageIndex=1,this.init_data()},group:function(t){this.pageIndex=1,this.init_data()},yearMonth:function(t){this.pageIndex=1,this.init_data()}},mounted:function(){this.init_data()},methods:{init_data:function(){var t=this;this.showLoading(),"from_did"!=this.group&&"intention_level"!=this.group||this.$rest(this.data_uri).get().success(function(e){t.data=e.list,t.loadFinished()})},loadFinished:function(){var t=this,e=this.data;e&&e.length>0&&e.push({column_total:!0}),setTimeout(function(){t.hideLoading()},300)},getTotal:function(t,e){var n=this.data,a=0;return n&&n.length>0&&(n.forEach(function(t){t[e]&&(a+=Number(t[e]))}),s._.isNumber(n[n.length-2][e])||(a=parseFloat(a).toFixed(2))),a},getProportion:function(t){var e=this.data,n=0,a=0;return e&&e.length&&(e.forEach(function(t){t.subtotal&&(n+=t.subtotal)}),a=parseFloat(t.subtotal/n*100).toFixed(2)),a}},computed:{tableHeight:function(){return(window.innerHeight||document.innerHeight)-(46+this.headerHeight)},columns:function(){var t=this,e=[],n={};n="from_did"==this.group?{title:"招生来源",key:"from_did",width:120,fixed:"left",render:function(e,n){return n.row.column_total?"合计":e("span",t.labelDicts(n.row.from_did,"from"))}}:{title:"意向级别",key:"intention_level",width:120,fixed:"left",render:function(t,e){return e.row.column_total?"合计":t("span",e.row.intention_level)}};var a={title:"客户数量",key:"subtotal",width:100,render:function(e,n){return n.row.column_total?e("span",{class:"text-danger"},t.getTotal(e,"subtotal")):n.row.subtotal}},i={title:"比例",key:"proportion",width:100,render:function(e,n){return n.row.column_total?"--":t.getProportion(n.row)}},r={title:"转化成功",key:"transfer_nums",width:100,render:function(e,n){return n.row.column_total?e("span",{class:"text-danger"},t.getTotal(e,"transfer_nums")):n.row.transfer_nums}},o={title:"转化率",key:"transfer_rate",width:100,render:function(e,n){if(n.row.column_total){var a=t.getTotal(e,"subtotal"),i=t.getTotal(e,"transfer_nums");return e("span",{class:"text-danger"},parseFloat(i/a*100).toFixed(2)+"%")}var r=n.row;return e("span",parseFloat(r.transfer_nums/r.subtotal*100).toFixed(2)+"%")}};return e.push(n,a,i,r,o),e},data_uri:function(){var t=this.group,e=this.yearMonth+"-01",n=this.yearMonth+"-"+(0,o.default)(this.yearMonth).daysInMonth(),a="";return this.bids.length&&(a=u.default.sprintf("&bid=[In,%s]",this.bids.join(","))),u.default.sprintf("%s?group=%s&start_date=%s&end_date=%s%s","report_customers",t,e,n,a)}}}},"37S0":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement;return(t._self._c||e)("x-table",{attrs:{height:t.tableHeight,width:"100%",border:!1,columns:t.columns,data:t.data}})},i=[],r={render:a,staticRenderFns:i};e.a=r},"9Rkr":function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n("+VlJ"),r=(a(i),n("VD+p")),o=a(r),s=n("TVG1"),u=a(s),d=n("8Llf"),l=a(d),f=n("KUj2"),c=a(f),h=n("m1Gx"),_=a(h);e.default={mixins:[l.default,c.default],components:{XTable:_.default},props:{bids:{type:Array,default:[]},yearMonth:{type:String,default:(0,o.default)(new Date).format("YYYY-MM")}},data:function(){return{data:[]}},watch:{bids:function(t){this.pageIndex=1,this.init_data()},yearMonth:function(t){this.pageIndex=1,this.init_data()}},mounted:function(){this.init_data()},methods:{init_data:function(){var t=this;this.showLoading(),this.$rest(this.data_uri).get().success(function(e){t.data=e.list,t.loadFinished()})},loadFinished:function(){var t=this,e=this.data;e&&e.length>0&&e.push({column_total:!0}),setTimeout(function(){t.hideLoading()},300)},getTotal:function(t,e){var n=this.data,a=0;return n&&n.length>0&&(n.forEach(function(t){t[e]&&(a+=Number(t[e]))}),s._.isNumber(n[n.length-2][e])||(a=parseFloat(a).toFixed(2))),a},getProportion:function(t){var e=this.data,n=0,a=0;return e&&e.length&&(e.forEach(function(t){t.subtotal&&(n+=t.subtotal)}),a=parseFloat(t.subtotal/n*100).toFixed(2)),a}},computed:{tableHeight:function(){return(window.innerHeight||document.innerHeight)-(46+this.headerHeight)},columns:function(){var t=this,e=[],n={title:"客户状态",key:"old_value",width:100,fixed:"left",render:function(e,n){return n.row.column_total?e("span","合计"):e("span",t.labelDicts(n.row.old_value,"customer_status"))}},a={title:"已跟进人数",key:"count_follow_up",width:120,render:function(e,n){return n.row.column_total?e("span",{class:"text-danger"},t.getTotal(e,"count_follow_up")):e("span",n.row.count_follow_up)}},i={title:"进阶人数",key:"count_advance",width:100,render:function(e,n){return n.row.column_total?e("span",{class:"text-danger"},t.getTotal(e,"count_advance")):n.row.count_advance}},r={title:"进阶率",key:"advance_rate",width:100,render:function(t,e){return e.row.column_total?"--":t("span",(100*e.row.advance_rate).toFixed(2)+"%")}},o={title:"转化人数",key:"count_transfer",width:100,render:function(e,n){return n.row.column_total?e("span",{class:"text-danger"},t.getTotal(e,"count_transfer")):n.row.count_transfer}},s={title:"转化率",key:"conversion_rate",width:100,render:function(t,e){return e.row.column_total?"--":t("span",(100*e.row.conversion_rate).toFixed(2)+"%")}};return e.push(n,a,i,r,o,s),e},data_uri:function(){var t=this.yearMonth+"-01",e=this.yearMonth+"-"+(0,o.default)(this.yearMonth).daysInMonth(),n="";return this.bids.length&&(n=u.default.sprintf("&bid=%s",this.bids.join(","))),u.default.sprintf("report_customers/conversion_rate?date_period=%s,%s%s",t,e,n)}}}},FcUo:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n("+6Lo"),r=a(i),o=n("S9nr"),s=a(o),u=n("o+C2"),d=a(u),l=n("EBxd"),f=a(l),c=n("ruvx"),h=a(c),_=n("I9ow"),p=a(_),m=n("QC6l"),g=a(m),b=n("l3Tv"),w=a(b);e.default={mixins:[r.default],components:{Datetime:s.default,PopupPicker:d.default,SelectBranch:f.default,TableReferer:h.default,TableAnalysis:p.default,TableSalesFunnel:g.default,TablePercentConversion:w.default},data:function(){return{popupShow:!1,filter:["from_did"],filterList:[{name:"按来源统计",value:"from_did"},{name:"按意向统计",value:"intention_level"},{name:"销售漏斗",value:"1"},{name:"转化率分析",value:"2"},{name:"转介绍统计",value:"3"}]}}}},I9ow:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("+wM7");n.n(a);for(var i in a)"default"!==i&&function(t){n.d(e,t,function(){return a[t]})}(i);var r=n("RYSt"),o=n.n(r),s=n("rwYs"),u=n("C7Lr"),d=u(o.a,s.a,!1,null,null,null);e.default=d.exports},QC6l:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("eGxO");n.n(a);for(var i in a)"default"!==i&&function(t){n.d(e,t,function(){return a[t]})}(i);var r=n("mm9v"),o=n.n(r),s=n("37S0"),u=n("C7Lr"),d=u(o.a,s.a,!1,null,null,null);e.default=d.exports},RYSt:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n("+VlJ"),r=(a(i),n("VD+p")),o=a(r),s=n("TVG1"),u=a(s),d=n("8Llf"),l=a(d),f=n("KUj2"),c=a(f),h=n("m1Gx"),_=a(h);e.default={mixins:[l.default,c.default],components:{XTable:_.default},props:{bids:{type:Array,default:[]},group:{type:String,default:"from_did"},yearMonth:{type:String,default:(0,o.default)(new Date).format("YYYY-MM")}},data:function(){return{data:[]}},watch:{bids:function(t){this.pageIndex=1,this.init_data()},group:function(t){this.pageIndex=1,this.init_data()},yearMonth:function(t){this.pageIndex=1,this.init_data()}},mounted:function(){this.init_data()},methods:{init_data:function(){var t=this;this.showLoading(),"from_did"!=this.group&&"intention_level"!=this.group||this.$rest(this.data_uri).get().success(function(e){t.data=e.list,t.loadFinished()})},loadFinished:function(){var t=this,e=this.data;e&&e.length>0&&e.push({column_total:!0}),setTimeout(function(){t.hideLoading()},300)},getTotal:function(t,e){var n=this.data,a=0;return n&&n.length>0&&(n.forEach(function(t){t[e]&&(a+=Number(t[e]))}),s._.isNumber(n[n.length-2][e])||(a=parseFloat(a).toFixed(2))),a},getProportion:function(t){var e=this.data,n=0,a=0;return e&&e.length&&(e.forEach(function(t){t.subtotal&&(n+=t.subtotal)}),a=parseFloat(t.subtotal/n*100).toFixed(2)),a}},computed:{tableHeight:function(){return(window.innerHeight||document.innerHeight)-(46+this.headerHeight)},columns:function(){var t=this,e=[],n={};n="from_did"==this.group?{title:"招生来源",key:"from_did",width:120,fixed:"left",render:function(e,n){return n.row.column_total?"合计":e("span",t.labelDicts(n.row.from_did,"from"))}}:{title:"意向级别",key:"intention_level",width:120,fixed:"left",render:function(t,e){return e.row.column_total?"合计":t("span",e.row.intention_level)}};var a={title:"客户数量",key:"subtotal",width:100,render:function(e,n){return n.row.column_total?e("span",{class:"text-danger"},t.getTotal(e,"subtotal")):n.row.subtotal}},i={title:"比例",key:"proportion",width:100,render:function(e,n){return n.row.column_total?"--":t.getProportion(n.row)}},r={title:"转化成功",key:"transfer_nums",width:100,render:function(e,n){return n.row.column_total?e("span",{class:"text-danger"},t.getTotal(e,"transfer_nums")):n.row.transfer_nums}},o={title:"转化率",key:"transfer_rate",width:100,render:function(e,n){if(n.row.column_total){var a=t.getTotal(e,"subtotal"),i=t.getTotal(e,"transfer_nums");return e("span",{class:"text-danger"},parseFloat(i/a*100).toFixed(2)+"%")}var r=n.row;return e("span",parseFloat(r.transfer_nums/r.subtotal*100).toFixed(2)+"%")}};return e.push(n,a,i,r,o),e},data_uri:function(){var t=this.group,e=this.yearMonth+"-01",n=this.yearMonth+"-"+(0,o.default)(this.yearMonth).daysInMonth(),a="";return this.bids.length&&(a=u.default.sprintf("&bid=[In,%s]",this.bids.join(","))),u.default.sprintf("%s?group=%s&start_date=%s&end_date=%s%s","report_customers",t,e,n,a)}}}},S0EL:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bg-white height-full"},[n("div",{staticClass:"x-header"},[n("span",{staticClass:"icon icon-ios-arrow-left",on:{click:t.preMonth}}),t._v(" "),n("datetime",{attrs:{format:"YYYY-MM","max-year":t.maxYear},model:{value:t.yearMonth,callback:function(e){t.yearMonth=e},expression:"yearMonth"}},[n("span",{staticClass:"title"},[t._v(t._s(t.title))])]),t._v(" "),n("span",{staticClass:"icon icon-ios-arrow-right",on:{click:t.nextMonth}}),t._v(" "),n("div",{staticClass:"x-header-filter",on:{click:function(e){t.popupShow=!0}}},[n("i",{staticClass:"icon icon-funnel"}),t._v("\n\t\t\t"+t._s(t.$refs.filter?t.$refs.filter.getNameValues():"按来源统计")+"\n\t\t")])],1),t._v(" "),n("select-branch",{model:{value:t.bids,callback:function(e){t.bids=e},expression:"bids"}}),t._v(" "),1==t.filter[0]?n("table-sales-funnel",{attrs:{bids:t.bids,"year-month":t.yearMonth}}):t._e(),t._v(" "),2==t.filter[0]?n("table-percent-conversion",{attrs:{bids:t.bids,"year-month":t.yearMonth}}):t._e(),t._v(" "),3==t.filter[0]?n("table-referer",{attrs:{bids:t.bids,"year-month":t.yearMonth}}):n("table-analysis",{attrs:{bids:t.bids,"year-month":t.yearMonth,group:t.filter[0]}}),t._v(" "),n("popup-picker",{ref:"filter",attrs:{show:t.popupShow,"show-cell":!1,columns:1,data:t.filterList},on:{"update:show":function(e){t.popupShow=e}},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})],1)},i=[],r={render:a,staticRenderFns:i};e.a=r},T9yI:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement;return(t._self._c||e)("x-table",{attrs:{height:t.tableHeight,width:"100%",border:!1,columns:t.columns,data:t.data}})},i=[],r={render:a,staticRenderFns:i};e.a=r},Z8dG:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n("+VlJ"),r=(a(i),n("VD+p")),o=a(r),s=n("TVG1"),u=a(s),d=n("8Llf"),l=a(d),f=n("KUj2"),c=a(f),h=n("m1Gx"),_=a(h);e.default={mixins:[l.default,c.default],components:{XTable:_.default},props:{bids:{type:Array,default:[]},yearMonth:{type:String,default:(0,o.default)(new Date).format("YYYY-MM")}},data:function(){return{data:[]}},watch:{bids:function(t){this.pageIndex=1,this.init_data()},yearMonth:function(t){this.pageIndex=1,this.init_data()}},mounted:function(){this.init_data()},methods:{init_data:function(){var t=this;this.showLoading(),this.$rest(this.data_uri).get().success(function(e){t.data=e.list,t.loadFinished()})},loadFinished:function(){var t=this,e=this.data;e&&e.length>0&&e.push({column_total:!0}),setTimeout(function(){t.hideLoading()},300)},getTotal:function(t,e){var n=this.data,a=0;return n&&n.length>0&&(n.forEach(function(t){t[e]&&(a+=Number(t[e]))}),s._.isNumber(n[n.length-2][e])||(a=parseFloat(a).toFixed(2))),a},getProportion:function(t){var e=this.data,n=0,a=0;return e&&e.length&&(e.forEach(function(t){t.subtotal&&(n+=t.subtotal)}),a=parseFloat(t.subtotal/n*100).toFixed(2)),a}},computed:{tableHeight:function(){return(window.innerHeight||document.innerHeight)-(46+this.headerHeight)},columns:function(){var t=this,e=[],n={title:"介绍人",key:"student_name",width:100,fixed:"left",render:function(t,e){return e.row.column_total?t("span","合计"):t("span",e.row.referer_student.student_name)}},a={title:"学号",key:"sno",width:100,render:function(t,e){return e.row.column_total?"--":t("span",e.row.referer_student.sno)}},i={title:"电话",key:"first_tel",width:150,render:function(t,e){return e.row.column_total?"--":e.row.referer_student.first_tel}},r={title:"状态",key:"status",width:100,render:function(t,e){return e.row.column_total?"--":t("span",e.row.status)}},o={title:"介绍人数",key:"subtotal",width:100,render:function(e,n){return n.row.column_total?e("span",{class:"text-danger"},t.getTotal(e,"subtotal")):n.row.subtotal}};return e.push(n,a,i,r,o),e},data_uri:function(){var t=this.yearMonth+"-01",e=this.yearMonth+"-"+(0,o.default)(this.yearMonth).daysInMonth(),n="";return this.bids.length&&(n=u.default.sprintf("&bid=[In,%s]",this.bids.join(","))),u.default.sprintf("report_customers?group=referer_sid&start_date=%s&end_date=%s%s",t,e,n)}}}},a15W:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n("+VlJ"),r=(a(i),n("VD+p")),o=a(r),s=n("TVG1"),u=a(s),d=n("8Llf"),l=a(d),f=n("KUj2"),c=a(f),h=n("m1Gx"),_=a(h);e.default={mixins:[l.default,c.default],components:{XTable:_.default},props:{bids:{type:Array,default:[]},yearMonth:{type:String,default:(0,o.default)(new Date).format("YYYY-MM")}},data:function(){return{data:[]}},watch:{bids:function(t){this.pageIndex=1,this.init_data()},yearMonth:function(t){this.pageIndex=1,this.init_data()}},mounted:function(){this.init_data()},methods:{init_data:function(){var t=this;this.showLoading(),this.$rest(this.data_uri).get().success(function(e){t.data=e.list,t.loadFinished()})},loadFinished:function(){var t=this,e=this.data;e&&e.length>0&&e.push({column_total:!0}),setTimeout(function(){t.hideLoading()},300)},getTotal:function(t,e){var n=this.data,a=0;return n&&n.length>0&&(n.forEach(function(t){t[e]&&(a+=Number(t[e]))}),s._.isNumber(n[n.length-2][e])||(a=parseFloat(a).toFixed(2))),a},getProportion:function(t){var e=this.data,n=0,a=0;return e&&e.length&&(e.forEach(function(t){t.subtotal&&(n+=t.subtotal)}),a=parseFloat(t.subtotal/n*100).toFixed(2)),a}},computed:{tableHeight:function(){return(window.innerHeight||document.innerHeight)-(46+this.headerHeight)},columns:function(){var t=this,e=[],n={title:"客户状态",key:"old_value",width:100,fixed:"left",render:function(e,n){return n.row.column_total?e("span","合计"):e("span",t.labelDicts(n.row.old_value,"customer_status"))}},a={title:"已跟进人数",key:"count_follow_up",width:120,render:function(e,n){return n.row.column_total?e("span",{class:"text-danger"},t.getTotal(e,"count_follow_up")):e("span",n.row.count_follow_up)}},i={title:"进阶人数",key:"count_advance",width:100,render:function(e,n){return n.row.column_total?e("span",{class:"text-danger"},t.getTotal(e,"count_advance")):n.row.count_advance}},r={title:"进阶率",key:"advance_rate",width:100,render:function(t,e){return e.row.column_total?"--":t("span",(100*e.row.advance_rate).toFixed(2)+"%")}},o={title:"转化人数",key:"count_transfer",width:100,render:function(e,n){return n.row.column_total?e("span",{class:"text-danger"},t.getTotal(e,"count_transfer")):n.row.count_transfer}},s={title:"转化率",key:"conversion_rate",width:100,render:function(t,e){return e.row.column_total?"--":t("span",(100*e.row.conversion_rate).toFixed(2)+"%")}};return e.push(n,a,i,r,o,s),e},data_uri:function(){var t=this.yearMonth+"-01",e=this.yearMonth+"-"+(0,o.default)(this.yearMonth).daysInMonth(),n="";return this.bids.length&&(n=u.default.sprintf("&bid=%s",this.bids.join(","))),u.default.sprintf("report_customers/conversion_rate?date_period=%s,%s%s",t,e,n)}}}},d0zt:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("FcUo");n.n(a);for(var i in a)"default"!==i&&function(t){n.d(e,t,function(){return a[t]})}(i);var r=n("d8yK"),o=n.n(r),s=n("S0EL"),u=n("C7Lr"),d=u(o.a,s.a,!1,null,null,null);e.default=d.exports},d8yK:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n("+6Lo"),r=a(i),o=n("S9nr"),s=a(o),u=n("o+C2"),d=a(u),l=n("EBxd"),f=a(l),c=n("ruvx"),h=a(c),_=n("I9ow"),p=a(_),m=n("QC6l"),g=a(m),b=n("l3Tv"),w=a(b);e.default={mixins:[r.default],components:{Datetime:s.default,PopupPicker:d.default,SelectBranch:f.default,TableReferer:h.default,TableAnalysis:p.default,TableSalesFunnel:g.default,TablePercentConversion:w.default},data:function(){return{popupShow:!1,filter:["from_did"],filterList:[{name:"按来源统计",value:"from_did"},{name:"按意向统计",value:"intention_level"},{name:"销售漏斗",value:"1"},{name:"转化率分析",value:"2"},{name:"转介绍统计",value:"3"}]}}}},eGxO:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n("+VlJ"),r=(a(i),n("VD+p")),o=a(r),s=n("TVG1"),u=a(s),d=n("8Llf"),l=a(d),f=n("KUj2"),c=a(f),h=n("m1Gx"),_=a(h);e.default={mixins:[l.default,c.default],components:{XTable:_.default},props:{bids:{type:Array,default:[]},yearMonth:{type:String,default:(0,o.default)(new Date).format("YYYY-MM")}},data:function(){return{data:[],columns:[]}},watch:{bids:function(t){this.pageIndex=1,this.init_data()},yearMonth:function(t){this.pageIndex=1,this.init_data()}},mounted:function(){this.formatColumn(),this.init_data()},methods:{init_data:function(){var t=this;this.showLoading(),this.$rest(this.data_uri).get().success(function(e){t.data=t.formatData(e),t.loadFinished()})},loadFinished:function(){var t=this,e=this.data;e&&e.length>0&&e.push({column_total:!0}),setTimeout(function(){t.hideLoading()},300)},getTotal:function(t,e){var n=this.data,a=0;return n&&n.length>0&&(n.forEach(function(t){t[e]&&(a+=Number(t[e]))}),s._.isNumber(n[n.length-2][e])||(a=parseFloat(a).toFixed(2))),a},formatColumn:function(){var t=this,e=[];e.push({title:"校区",key:"bid",fixed:"left",width:100,render:function(e,n){return t.$filter("branch_name")(n.row.bid)}}),this.cs_list.forEach(function(t){var n=t.did+t.title;e.push({title:t.title,key:n,width:100})}),e.push({title:"未指定",key:"0未指定",width:100}),e.push({title:"总计",key:"total",fixed:"right",width:70}),this.columns=e},formatData:function(t){var e=[],n=this.cs_list;return t.list.forEach(function(t){var a="",i=e.find(function(e){return e.bid==t.bid}),r=n.find(function(e){return e.did==t.customer_status_did});if(a=r?t.customer_status_did+r.title:t.customer_status_did+"未指定",i)i[a]=t.subtotal,i.total+=t.subtotal;else{var o={};n.forEach(function(t){o[t.did+t.title]=0}),o.bid=t.bid,o.total=0,o["0未指定"]=0,o[a]=t.subtotal,o.total+=t.subtotal,e.push(o)}}),e}},computed:{tableHeight:function(){return(window.innerHeight||document.innerHeight)-(46+this.headerHeight)},cs_list:function(){return this.$store.state.gvars.dicts.customer_status},data_uri:function(){var t=this.yearMonth+"-01",e=this.yearMonth+"-"+(0,o.default)(this.yearMonth).daysInMonth(),n="";return this.bids.length&&(n=u.default.sprintf("&bid=[In,%s]",this.bids.join(","))),u.default.sprintf("report_customers?group=bid,customer_status_did&start_date=%s&end_date=%s%s",t,e,n)}}}},l3Tv:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("9Rkr");n.n(a);for(var i in a)"default"!==i&&function(t){n.d(e,t,function(){return a[t]})}(i);var r=n("a15W"),o=n.n(r),s=n("p6WA"),u=n("C7Lr"),d=u(o.a,s.a,!1,null,null,null);e.default=d.exports},mm9v:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n("+VlJ"),r=(a(i),n("VD+p")),o=a(r),s=n("TVG1"),u=a(s),d=n("8Llf"),l=a(d),f=n("KUj2"),c=a(f),h=n("m1Gx"),_=a(h);e.default={mixins:[l.default,c.default],components:{XTable:_.default},props:{bids:{type:Array,default:[]},yearMonth:{type:String,default:(0,o.default)(new Date).format("YYYY-MM")}},data:function(){return{data:[],columns:[]}},watch:{bids:function(t){this.pageIndex=1,this.init_data()},yearMonth:function(t){this.pageIndex=1,this.init_data()}},mounted:function(){this.formatColumn(),this.init_data()},methods:{init_data:function(){var t=this;this.showLoading(),this.$rest(this.data_uri).get().success(function(e){t.data=t.formatData(e),t.loadFinished()})},loadFinished:function(){var t=this,e=this.data;e&&e.length>0&&e.push({column_total:!0}),setTimeout(function(){t.hideLoading()},300)},getTotal:function(t,e){var n=this.data,a=0;return n&&n.length>0&&(n.forEach(function(t){t[e]&&(a+=Number(t[e]))}),s._.isNumber(n[n.length-2][e])||(a=parseFloat(a).toFixed(2))),a},formatColumn:function(){var t=this,e=[];e.push({title:"校区",key:"bid",fixed:"left",width:100,render:function(e,n){return t.$filter("branch_name")(n.row.bid)}}),this.cs_list.forEach(function(t){var n=t.did+t.title;e.push({title:t.title,key:n,width:100})}),e.push({title:"未指定",key:"0未指定",width:100}),e.push({title:"总计",key:"total",fixed:"right",width:70}),this.columns=e},formatData:function(t){var e=[],n=this.cs_list;return t.list.forEach(function(t){var a="",i=e.find(function(e){return e.bid==t.bid}),r=n.find(function(e){return e.did==t.customer_status_did});if(a=r?t.customer_status_did+r.title:t.customer_status_did+"未指定",i)i[a]=t.subtotal,i.total+=t.subtotal;else{var o={};n.forEach(function(t){o[t.did+t.title]=0}),o.bid=t.bid,o.total=0,o["0未指定"]=0,o[a]=t.subtotal,o.total+=t.subtotal,e.push(o)}}),e}},computed:{tableHeight:function(){return(window.innerHeight||document.innerHeight)-(46+this.headerHeight)},cs_list:function(){return this.$store.state.gvars.dicts.customer_status},data_uri:function(){var t=this.yearMonth+"-01",e=this.yearMonth+"-"+(0,o.default)(this.yearMonth).daysInMonth(),n="";return this.bids.length&&(n=u.default.sprintf("&bid=[In,%s]",this.bids.join(","))),u.default.sprintf("report_customers?group=bid,customer_status_did&start_date=%s&end_date=%s%s",t,e,n)}}}},p6WA:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement;return(t._self._c||e)("x-table",{attrs:{height:t.tableHeight,width:"100%",border:!1,columns:t.columns,data:t.data}})},i=[],r={render:a,staticRenderFns:i};e.a=r},ruvx:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("x3ET");n.n(a);for(var i in a)"default"!==i&&function(t){n.d(e,t,function(){return a[t]})}(i);var r=n("Z8dG"),o=n.n(r),s=n("T9yI"),u=n("C7Lr"),d=u(o.a,s.a,!1,null,null,null);e.default=d.exports},rwYs:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement;return(t._self._c||e)("x-table",{attrs:{height:t.tableHeight,width:"100%",border:!1,columns:t.columns,data:t.data}})},i=[],r={render:a,staticRenderFns:i};e.a=r},x3ET:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n("+VlJ"),r=(a(i),n("VD+p")),o=a(r),s=n("TVG1"),u=a(s),d=n("8Llf"),l=a(d),f=n("KUj2"),c=a(f),h=n("m1Gx"),_=a(h);e.default={mixins:[l.default,c.default],components:{XTable:_.default},props:{bids:{type:Array,default:[]},yearMonth:{type:String,default:(0,o.default)(new Date).format("YYYY-MM")}},data:function(){return{data:[]}},watch:{bids:function(t){this.pageIndex=1,this.init_data()},yearMonth:function(t){this.pageIndex=1,this.init_data()}},mounted:function(){this.init_data()},methods:{init_data:function(){var t=this;this.showLoading(),this.$rest(this.data_uri).get().success(function(e){t.data=e.list,t.loadFinished()})},loadFinished:function(){var t=this,e=this.data;e&&e.length>0&&e.push({column_total:!0}),setTimeout(function(){t.hideLoading()},300)},getTotal:function(t,e){var n=this.data,a=0;return n&&n.length>0&&(n.forEach(function(t){t[e]&&(a+=Number(t[e]))}),s._.isNumber(n[n.length-2][e])||(a=parseFloat(a).toFixed(2))),a},getProportion:function(t){var e=this.data,n=0,a=0;return e&&e.length&&(e.forEach(function(t){t.subtotal&&(n+=t.subtotal)}),a=parseFloat(t.subtotal/n*100).toFixed(2)),a}},computed:{tableHeight:function(){return(window.innerHeight||document.innerHeight)-(46+this.headerHeight)},columns:function(){var t=this,e=[],n={title:"介绍人",key:"student_name",width:100,fixed:"left",render:function(t,e){return e.row.column_total?t("span","合计"):t("span",e.row.referer_student.student_name)}},a={title:"学号",key:"sno",width:100,render:function(t,e){return e.row.column_total?"--":t("span",e.row.referer_student.sno)}},i={title:"电话",key:"first_tel",width:150,render:function(t,e){return e.row.column_total?"--":e.row.referer_student.first_tel}},r={title:"状态",key:"status",width:100,render:function(t,e){return e.row.column_total?"--":t("span",e.row.status)}},o={title:"介绍人数",key:"subtotal",width:100,render:function(e,n){return n.row.column_total?e("span",{class:"text-danger"},t.getTotal(e,"subtotal")):n.row.subtotal}};return e.push(n,a,i,r,o),e},data_uri:function(){var t=this.yearMonth+"-01",e=this.yearMonth+"-"+(0,o.default)(this.yearMonth).daysInMonth(),n="";return this.bids.length&&(n=u.default.sprintf("&bid=[In,%s]",this.bids.join(","))),u.default.sprintf("report_customers?group=referer_sid&start_date=%s&end_date=%s%s",t,e,n)}}}}});
//# sourceMappingURL=14.a0c8eb49b82db3c5bac9.js.map