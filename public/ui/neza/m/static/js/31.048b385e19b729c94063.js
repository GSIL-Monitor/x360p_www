webpackJsonp([31],{"/NtJ":function(t,n,e){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("VD+p"),s=i(o),a=e("TVG1"),c=i(a),r=e("8Llf"),l=i(r),d=e("/AUM"),u=i(d),f=e("E3ZX"),h=i(f),m=e("+CBI"),_=i(m),p=e("JlEs"),v=i(p),g=e("jbqM"),w=i(g),k=e("gP80"),b=i(k),y=e("gpPJ"),R=i(y),x=e("CKVb"),D=i(x),I=e("S9nr"),M=i(I),T=e("fvyU"),C=i(T),$=e("RAwi"),V=i($),Y=e("IXui"),j=i(Y);n.default={mixins:[l.default,u.default,h.default],components:{Cell:R.default,Group:D.default,XInput:C.default,XButton:j.default,iSwitch:_.default,Datetime:M.default,XTextarea:V.default,SmallVoice:v.default,SelectClass:b.default,SelectFile:w.default},data:function(){return{info:{lid:0,bid:0,sids:[],sid:0,cid:0,eid:0,remark:"",is_push:!0,deadline:(0,s.default)(new Date).add(7,"days").format("YYYY-MM-DD"),content:"",homework_attachment:[],lesson_type:1,_class_name:""},startDate:(0,s.default)(new Date).format("YYYY-MM-DD"),showRecord:!1}},methods:{file_list:function(t){var n=[[],this.info.homework_attachment],e=n[0],i=n[1];return i.length>0&&(e=i.filter(function(n){return n.file_type==t})),e},delItem:function(t){var n=this.info.homework_attachment.indexOf(t);n>-1&&this.info.homework_attachment.splice(n,1)},chooseWXImage:function(){var t=this,n=9-this.file_list("image").length;this.chooseImage(n,!1).then(function(n){n.length&&n.forEach(function(n){var e={file_type:"image",file_url:n};t.isIOS&&t.getlocalImageData(t.images.localId[n]).then(function(t){e.file_url=t}),t.info.homework_attachment.push(e)})})},ok:function(){return this.info.eid=this.eid$,0==this.info.cid?void this.toast("请选择作业班级","warn"):/^\s*$/.test(this.info.content)?void this.toast("请输入作业内容","warn"):void this.post()},post:function(){var t=this,n=c.default.copy(this.info);n.deadline=c.default.format_int_day(n.deadline),this.$rest("homework_tasks").post(n).success(function(n){t.toast("布置成功","success"),setTimeout(function(){t.$router.go(-1)},1e3)}).error(function(n){t.toast(n.body.message||"布置失败！","warn")})},chooseObject:function(){this.$refs.object.show()},setObject:function(t){this.info.lid=t.lid,this.info.lesson_type=0,this.info.bid=t.bid}}}},"31L6":function(t,n,e){"use strict";function i(t){e("I3gL")}Object.defineProperty(n,"__esModule",{value:!0});var o=e("/NtJ");e.n(o);for(var s in o)"default"!==s&&function(t){e.d(n,t,function(){return o[t]})}(s);var a=e("AvuX"),c=e.n(a),r=e("JjZn"),l=e("C7Lr"),d=i,u=l(c.a,r.a,!1,d,null,null);n.default=u.exports},AvuX:function(t,n,e){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("VD+p"),s=i(o),a=e("TVG1"),c=i(a),r=e("8Llf"),l=i(r),d=e("/AUM"),u=i(d),f=e("E3ZX"),h=i(f),m=e("+CBI"),_=i(m),p=e("JlEs"),v=i(p),g=e("jbqM"),w=i(g),k=e("gP80"),b=i(k),y=e("gpPJ"),R=i(y),x=e("CKVb"),D=i(x),I=e("S9nr"),M=i(I),T=e("fvyU"),C=i(T),$=e("RAwi"),V=i($),Y=e("IXui"),j=i(Y);n.default={mixins:[l.default,u.default,h.default],components:{Cell:R.default,Group:D.default,XInput:C.default,XButton:j.default,iSwitch:_.default,Datetime:M.default,XTextarea:V.default,SmallVoice:v.default,SelectClass:b.default,SelectFile:w.default},data:function(){return{info:{lid:0,bid:0,sids:[],sid:0,cid:0,eid:0,remark:"",is_push:!0,deadline:(0,s.default)(new Date).add(7,"days").format("YYYY-MM-DD"),content:"",homework_attachment:[],lesson_type:1,_class_name:""},startDate:(0,s.default)(new Date).format("YYYY-MM-DD"),showRecord:!1}},methods:{file_list:function(t){var n=[[],this.info.homework_attachment],e=n[0],i=n[1];return i.length>0&&(e=i.filter(function(n){return n.file_type==t})),e},delItem:function(t){var n=this.info.homework_attachment.indexOf(t);n>-1&&this.info.homework_attachment.splice(n,1)},chooseWXImage:function(){var t=this,n=9-this.file_list("image").length;this.chooseImage(n,!1).then(function(n){n.length&&n.forEach(function(n){var e={file_type:"image",file_url:n};t.isIOS&&t.getlocalImageData(t.images.localId[n]).then(function(t){e.file_url=t}),t.info.homework_attachment.push(e)})})},ok:function(){return this.info.eid=this.eid$,0==this.info.cid?void this.toast("请选择作业班级","warn"):/^\s*$/.test(this.info.content)?void this.toast("请输入作业内容","warn"):void this.post()},post:function(){var t=this,n=c.default.copy(this.info);n.deadline=c.default.format_int_day(n.deadline),this.$rest("homework_tasks").post(n).success(function(n){t.toast("布置成功","success"),setTimeout(function(){t.$router.go(-1)},1e3)}).error(function(n){t.toast(n.body.message||"布置失败！","warn")})},chooseObject:function(){this.$refs.object.show()},setObject:function(t){this.info.lid=t.lid,this.info.lesson_type=0,this.info.bid=t.bid}}}},E3ZX:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("TVG1"),o=function(t){return t&&t.__esModule?t:{default:t}}(i);n.default={data:function(){return{recording:!1,time:0,time_out:null}},mounted:function(){},methods:{closeRecordMask:function(){this.recording||(this.showRecord=!1)},record:function(){this.recording=!this.recording,this.recording?this.startRecordVoice():this.stopRecordVoice()},onVoiceAutoEnd:function(){var t=this;this.onVoiceRecordEnd().then(function(n){t.recording=!1;var e={file_id:n.file_id,file_type:"voice",file_url:n.file_url,duration:o.default.copy(t.time)};t.info.homework_attachment.push(e),t.resetTime(),t.showRecord=!1})},startRecordVoice:function(){var t=this;this.recording=!0,this.onVoiceAutoEnd(),this.startRecord().then(function(){t.time_out=setTimeout(t.timeCounting,1e3)})},stopRecordVoice:function(){var t=this;this.recording=!1,this.stopRecord().then(function(n){var e={file_id:n.file_id,file_type:"voice",file_url:n.file_url,duration:o.default.copy(t.time)};t.info.homework_attachment.push(e),t.resetTime()}),this.showRecord=!1},resetTime:function(){this.time=0,this.time_out&&window.clearTimeout(this.time_out),this.setRecordTime&&window.clearTimeout(this.setRecordTime)},timeCounting:function(){this.time=0,this.setRecordTime()},setRecordTime:function(){this.time<60&&this.recording&&(this.time++,window.setTimeout(this.setRecordTime,1e3))}},computed:{recordTime:function(){var t=this.time,n="0:"+(t<10?"0"+t:t);return 60==t&&(n="1:00"),n}}}},I3gL:function(t,n,e){var i=e("JGDe");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);e("FIqI")("1d554377",i,!0,{})},JGDe:function(t,n,e){n=t.exports=e("UTlt")(!0),n.push([t.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","",{version:3,sources:[],names:[],mappings:"",file:"add.vue",sourceRoot:""}])},JjZn:function(t,n,e){"use strict";var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("group",[e("select-class",{on:{"on-selected":t.setObject},model:{value:t.info.cid,callback:function(n){t.$set(t.info,"cid",n)},expression:"info.cid"}}),t._v(" "),e("datetime",{attrs:{title:"截止日期","start-date":t.startDate},model:{value:t.info.deadline,callback:function(n){t.$set(t.info,"deadline",n)},expression:"info.deadline"}}),t._v(" "),e("x-textarea",{attrs:{placeholder:"请输入作业内容"},model:{value:t.info.content,callback:function(n){t.$set(t.info,"content",n)},expression:"info.content"}}),t._v(" "),e("div",{staticClass:"bg-white pd-10 text-right"},[e("span",{staticClass:"text-desc text-small mg-r-10",on:{click:function(n){t.showRecord=!0}}},[e("i",{staticClass:"icon icon-mic-a"}),t._v("\n\t\t\t\t点击录音\n\t\t\t")])])],1),t._v(" "),e("group",{attrs:{title:"作业附件"}},[e("select-file",{model:{value:t.info.homework_attachment,callback:function(n){t.$set(t.info,"homework_attachment",n)},expression:"info.homework_attachment"}})],1),t._v(" "),e("group",[e("x-input",{attrs:{title:"备注",placeholder:"请输入备注","text-align":"right"},model:{value:t.info.remark,callback:function(n){t.$set(t.info,"remark",n)},expression:"info.remark"}}),t._v(" "),e("cell",{attrs:{title:"是否推送给学生"}},[e("i-switch",{model:{value:t.info.is_push,callback:function(n){t.$set(t.info,"is_push",n)},expression:"info.is_push"}})],1)],1),t._v(" "),e("div",{staticClass:"pd-10"},[e("x-button",{attrs:{type:"x-btn btn-bg-theme"},nativeOn:{click:function(n){return t.ok(n)}}},[t._v("提交")])],1),t._v(" "),t.showRecord?e("div",[e("div",{ref:"recordMask",staticClass:"record-mask",on:{click:t.closeRecordMask}}),t._v(" "),e("div",{staticClass:"recording-container"},[e("div",{staticClass:"record-time"},[t._v(t._s(t.recordTime))]),t._v(" "),e("span",{staticClass:"record-btn",class:t.recording?"active":"",on:{click:t.record}})])]):t._e()],1)},o=[],s={render:i,staticRenderFns:o};n.a=s}});
//# sourceMappingURL=31.048b385e19b729c94063.js.map