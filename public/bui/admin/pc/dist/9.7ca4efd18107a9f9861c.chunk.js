webpackJsonp([9],{311:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i(425),a=i(599),n=i(16),l=n(s.a,a.a,!1,null,null,null);l.options.__file="src/views/business/services.vue",t.default=l.exports},331:function(e,t,i){"use strict";t.a={name:"filterColumn",props:{keys:{type:Object,default:function(){return{}}}}}},332:function(e,t,i){"use strict";function s(e,t){var i=[];for(var s in this.operation_keys){var a=this.operation_keys[s],n=[],l=void 0,o=!0;a.per&&n.push({name:"per",value:a.per,expression:"",arg:"display",modifiers:{}}),a.condition&&(r.b.isString(a.condition)?l=new Function("row","params","return "+a.condition):r.b.isFunction(condition)&&(l=condition),r.b.isFunction(l)&&(l(t.row,t)||(o=!1))),r.b.isFunction(this.operation_func[s])&&!1!==a.show&&o&&i.push(e("Dropdown-item",{nativeOn:{click:this.operation_func[s].bind(this,t)},directives:n},[e("Icon",{props:{type:a.type}})," ",a.title]))}return e("div",[e("Dropdown",{props:{placement:"bottom-start",trigger:"click"}},[e("Button",{props:{type:"primary",size:"small"}},["操作"," ",e("Icon",{props:{type:"arrow-down-b"}})]),e("Dropdown-menu",{slot:"list"},i)])])}var a=i(49),n=i.n(a),l=i(13),o=i.n(l),r=(i(21),i(201),i(5)),c=i(335),d={int_day:function(e,t){return this.$filter("int_date")(t.row.int_day)}};t.a={components:{FilterColumn:c.a},data:function(){return{imgView:!1,bigImage:"",loading:!1,rest_api:"",searchExpand:!1,params:{search_field:"name",search_value:"",order_field:"",order_sort:"",last_search_value:"",bid:""},data:[],modal:{title:"",action:"add",show:!1},total:0,pageIndex:1,pageSize:10,init_page_size:0,bigPageSizeOption:[10,20,40,60,80,100],showCheckbox:!1,showIndex:!0,column_keys:{},column_render:{},operation_keys:{},operation_func:{},column_operation_text:"操作"}},methods:{sortChange:function(e){this.params.order_field=e.key,this.params.order_sort=e.order,this.init_data()},pagenation:function(e){this.pageIndex=e,this.init_data()},pagesize:function(e){if(this.pageSize=e,0==this.init_page_size)return void(this.init_page_size=1);this.init_data()},toggleSearch:function(){this.searchExpand=!this.searchExpand},search:function(){this.pagenation(1)},resetSearch:function(){this.params.search_value="",this.init_data()},init_data:function(){var e=this;if(this.loading)return!1;if(""!=this.rest_api){var t={};t.page=this.pageIndex,t.pagesize=this.pageSize,""!=this.params.search_value?(t.search_field=this.params.search_field,t.search_value=this.params.search_value,this.params.last_search_value=this.params.search_value):this.params.last_search_value="",""!=this.params.order_field&&(t.order_field=this.params.order_field,t.order_sort=this.params.order_sort),this.hook_get_param(t);for(var i in t)null===t[i]&&delete t[i];var s=this.rest_api;-1!==this.rest_api.indexOf("/:")&&(s=this.replace_rest_api(this.rest_api,t)),this.loading=!0,this.$rest(s).get(t).success(function(i){e.params=r.a.copy(t),e.data=e.deal_data(i),e.total=i.total,e.pageSize=parseInt(i.pagesize),e.loading=!1}).error(function(t){e.loading=!1})}},replace_rest_api:function(e,t){if(e.match(/:([^\/]+)\//)){var i=RegExp.$1;void 0!==t[i]&&(e=e.replace(":"+i,t[i]))}return e},hook_get_param:function(e){},deal_data:function(e){return e.list},check:function(){var e=this;return new o.a(function(t,i){e.$refs["form_"+e.datakey].validate(function(e){e?t():i()})})},add:function(){this.modal.action="add",this.modal.title="添加"+this.res_name,this.modal.show=!0,this[this.datakey][this.pk]=null},edit:function(e){this.rest_id=e[this.pk],n()(this[this.datakey],e),this.modal.action="edit",this.modal.title="编辑"+this.res_name,this.modal.show=!0},save:function(){var e=this;return new o.a(function(t,i){var s=e.rest_api,a=e[e.datakey];e.check().then(function(){var n="add"==e.modal.action?"post":"put",l=(e.modal.action,e.$rest(s));"add"!=e.modal.action&&l.add_url_param(e.rest_id),l[n](a).success(function(i){e.close(),e.init_data(),t(i)}).error(function(t){e.$Message.error(t.body.message),i(t)})})})},close:function(){this.modal.show=!1},delete:function(e){var t=this;return new o.a(function(i,s){t.$rest(t.rest_api).delete(e[t.pk]).success(function(e,s){t.init_data(),i(e)}).error(function(e,i){t.$Message.error(e.body.message),s(e)})})},do:function(e,t,i){var s=this;return new o.a(function(a,n){s.$rest(s.rest_api).add_url_param(t[s.pk],"do"+e).post(i).success(function(e){s.init_data(),a(e)}).error(function(e){s.$Message.error(e.body.message),n(e)})})},confirm:function(e){var t=this;return new o.a(function(i,s){t.$Modal.confirm({content:e||"您确定要进行删除操作吗?",onOk:function(){i()},onCancel:function(){s()}})})},fixLeft:function(){return this.data.length>0&&"left"},fixRight:function(){return this.data.length>0&&"right"},exportCSV:function(e,t){this.$refs[t].exportCsv({filename:e})},view_img:function(e){this.imgView=!0,this.bigImage=e}},computed:{toggleSearchIcon:function(){return this.searchExpand?"chevron-up":"chevron-down"},export_params:function(){var e={};e.page=this.pageIndex,e.pagesize=this.pageSize,""!=this.params.search_value&&(e[this.params.search_field]=this.params.search_value),this.hook_get_param(e);for(var t in e)null===e[t]&&delete e[t];return e},columns_head:function(){var e=[];return this.showCheckbox&&e.push({type:"selection",width:60,align:"center"}),this.showIndex&&e.push({type:"index",width:60,align:"center"}),e},columns:function(){var e=[],t={},i=this.column_render;n()(e,this.columns_head);for(var a in this.column_keys){var l=this.column_keys[a];if(void 0===l.show&&(l.show=!0),void 0===l.disabled&&(l.disabled=!1),l.show){var o=n()({key:a},l);i[a]?o.render=i[a].bind(this):d[a]&&(o.render=d[a].bind(this)),e.push(o)}}if(r.b.isEmpty(this.operation_btn)||(t.key="operation",t.title=this.column_operation_text,t.width=80,t.render=this.operation_btn.operation.bind(this),e.push(t)),r.b.isEmpty(this.operation_keys)||(t.key="operation",t.title=this.column_operation_text,t.width=80,t.render=s.bind(this),e.unshift(t)),!r.b.isEmpty(this.expand_render)){var c={};c.type="expand",c.width=50,c.render=this.expand_render.expand.bind(this),e.unshift(c)}return e},upload_header:function(){return{"x-token":this.$store.state.user.token,"x-file-key":"file"}},upload_post:function(){return{mod:"attachment_file"}}},watch:{}}},333:function(e,t,i){"use strict";t.__esModule=!0;var s=i(339),a=function(e){return e&&e.__esModule?e:{default:e}}(s);t.default=function(e,t,i){return t in e?(0,a.default)(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}},334:function(e,t){},335:function(e,t,i){"use strict";function s(e){l||i(334)}var a=i(331),n=i(336),l=!1,o=i(16),r=s,c=o(a.a,n.a,!1,r,null,null);c.options.__file="src/views/components/FilterColumn.vue",t.a=c.exports},336:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"filter-column"},[i("Dropdown",{attrs:{placement:"bottom-end"}},[i("Button",{attrs:{type:"primary"}},[e._v("\r\n    \t\t选择列\r\n            "),i("Icon",{attrs:{type:"funnel"}})],1),e._v(" "),i("Dropdown-menu",{attrs:{slot:"list"},slot:"list"},e._l(e.keys,function(t){return i("Dropdown-item",[i("Checkbox",{nativeOn:{click:function(e){e.stopPropagation(),t.show=t.show}},model:{value:t.show,callback:function(i){e.$set(t,"show",i)},expression:"item.show"}},[e._v(e._s(t.title))])],1)}))],1)],1)},a=[];s._withStripped=!0;var n={render:s,staticRenderFns:a};t.a=n},337:function(e,t,i){"use strict";var s=i(198),a=i(5);t.a={mixins:[s.a],name:"DateRangePicker",props:{value:{type:Array},label:{type:String},size:{type:String}},methods:{dateChange:function(e){var t=this;this.date_arr=e,this.$emit("input",e),this.$nextTick(function(){t.dispatch("FormItem","on-form-change",e)})},ok:function(){this.$emit("on-change",this.date_arr)},clear:function(){this.date_arr[0]="",this.date_arr[1]="",this.$emit("on-change",this.date_arr)}},computed:{placeholder:function(){return this.label||"请选择日期"}},data:function(){return{date_arr:[],date_option:{shortcuts:[{text:"今天",value:function(){return a.a.today_range()}},{text:"本周",value:function(){return a.a.week_range()}},{text:"本月",value:function(){return a.a.month_range()}},{text:"最近一周",value:function(){return a.a.recent_week_range(1)}},{text:"最近一个月",value:function(){return a.a.recent_month_range(1)}},{text:"最近三个月",value:function(){return a.a.recent_month_range(3)}}]}}}}},338:function(e,t,i){"use strict";function s(e,t){for(var i=0;i<t.length;i++)if(e===t[i])return!0;return!1}function a(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=e.$children;return s.length&&s.forEach(function(e){var s=e.$options.name,n=e.$children;if(s===t&&i.push(e),n.length){var l=a(e,t,i);l&&i.concat(l)}}),i}t.a=s,i.d(t,"b",function(){return a});window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver},339:function(e,t,i){e.exports={default:i(340),__esModule:!0}},340:function(e,t,i){i(341);var s=i(1).Object;e.exports=function(e,t,i){return s.defineProperty(e,t,i)}},341:function(e,t,i){var s=i(6);s(s.S+s.F*!i(9),"Object",{defineProperty:i(8).f})},343:function(e,t,i){"use strict";var s=i(337),a=i(347),n=i(16),l=n(s.a,a.a,!1,null,null,null);l.options.__file="src/views/components/DateRangePicker.vue",t.a=l.exports},347:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement;return(e._self._c||t)("Date-picker",{attrs:{type:"daterange",value:e.value,size:e.size,confirm:"",options:e.date_option,placeholder:e.placeholder},on:{"on-change":e.dateChange,"on-clear":e.clear,"on-ok":e.ok}})},a=[];s._withStripped=!0;var n={render:s,staticRenderFns:a};t.a=n},351:function(e,t,i){"use strict";var s=i(333),a=i.n(s),n=i(338),l=i(363),o=(i(21),i(5),i(198)),r="ivu-select";t.a={name:"SelectClient",mixins:[o.a],components:{SelectClientModal:l.a},props:{value:{type:[Number,String,Array],default:0},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},placeholder:{type:String},loading:{type:Boolean,default:!1},loadingText:{type:String},size:{validator:function(e){return i.i(n.a)(e,["small","large","default"])}},notFoundText:{type:String},placement:{validator:function(e){return i.i(n.a)(e,["top","bottom"])},default:"bottom"},toFormal:{type:Boolean,default:!1}},data:function(){return{prefixCls:r,modalShow:!1,options:[],optionsInstances:[],labelText:"",model:this.value}},computed:{modalWidth:function(){return this.multiple?"900":"640"},multiple:function(){return!!Array.isArray(this.model)},classes:function(){var e;return["ivu-select",(e={},a()(e,"ivu-select-visible",this.visible),a()(e,"ivu-select-disabled",this.disabled),a()(e,"ivu-select-multiple",this.multiple),a()(e,"ivu-select-single",!this.multiple),a()(e,"ivu-select-show-clear",this.showCloseIcon),a()(e,"ivu-select-"+this.size,!!this.size),e)]},showPlaceholder:function(){var e=!1;return"string"==typeof this.model?""!==this.model&&"0"!==this.model||(e=!0):Array.isArray(this.model)?this.model.length||(e=!0):"number"==typeof this.model?0==this.model&&(e=!0):null===this.model&&(e=!0),e},localePlaceholder:function(){return void 0===this.placeholder?"请选择":this.placeholder},showCloseIcon:function(){return this.clearable&&!this.showPlaceholder}},methods:{openModal:function(){if(this.disabled)return!1;this.modalShow=!this.modalShow},updateSelected:function(e){var t=this;this.multiple?(this.model.length>0&&this.model.splice(0,this.model.length),e.forEach(function(e){t.model.push(e.cid)})):this.model=e.cid,this.updateLabelText(),this.$emit("on-change",this.model),this.$emit("input",this.model),this.$emit("select",this.model),this.$nextTick(function(){t.dispatch("FormItem","on-form-change",t.model)})},updateLabelText:function(){var e=this;this.multiple?this.model.length>0&&this.model[0]>0?this.$store.dispatch("getMapText",{id:this.model[0],name:"client",idf:"cid",txf:"client_name"}).then(function(t){var i=t;e.model.length>1&&(i+="等"+e.model.length+"个客户"),e.labelText=i}):this.labelText="":this.model?this.$store.dispatch("getMapText",{id:this.model,name:"client",idf:"cid",txf:"client_name"}).then(function(t){console.log("text:"+t),e.labelText=t}):this.labelText=""},clearSelected:function(){this.multiple?this.model.length>0&&this.model.splice(0,this.model.length):this.model=0,this.$emit("input",this.model)}},watch:{value:function(e){this.model=e,this.updateLabelText()}}}},352:function(e,t,i){"use strict";var s=i(333),a=i.n(s),n=(i(4),i(0)),l=i.n(n),o=i(332),r=i(202);i(21);t.a={name:"SelectClientModal",mixins:[o.a,r.a],props:{value:{type:Boolean,default:""},width:{type:String,default:""},title:{type:String,default:"选择客户"},multiple:{type:Boolean,default:!1},selected:{type:[Array,Number,String],default:[]},toFormal:{type:Boolean,default:!1}},data:function(){return{rest_api:"clients",modalShow:!1,selIds:[],is_data_init:!1,params:{search_field:"client_name"},checkAll:!1}},computed:{classes:function(){var e;return["select-list",(e={},a()(e,"select-list-multiple",this.multiple),a()(e,"select-list-single",!this.multiple),e)]},labelText:function(){if(this.selIds.length>0)return this.$store.getters.getMapText(this.selIds[0],"client")},isSelected:function(){return this.multiple?this.selIds.length>0&&0!=this.selIds[0]||void 0:0!=this.selIds[0]},selectedTotal:function(){return this.selIds.length},selectedList:function(){var e=this,t=[];return this.selIds.forEach(function(i){i>0&&t.push(e.$store.getters.getMapObject(i,"client"))}),t}},created:function(){this.setSelIds(this.selected)},methods:{setSelIds:function(e){0!==e&&""!=e&&0!==e.length||(this.selIds=[],this.refreshData(this.data)),this.multiple?(this.selIds=e,this.refreshData(this.data)):0==this.selIds.length?this.selIds.push(e):this.selIds.splice(0,1,e)},formatAge:function(e){return"1970-01-01 08:00:00"!==e?parseInt(l()(new Date).format("YYYY"))-parseInt(l()(e).format("YYYY"))+"岁":"未填写"},formatSex:function(e){return{0:"未确定",1:"男",2:"女"}[e]},ok:function(){if(!this.isSelected)return void this.$Message.error("没有选中任何客户");if(this.multiple)this.$emit("on-select",this.selectedList);else{var e=this.$store.getters.getMapObject(this.selIds[0],"client");this.$emit("on-select",e)}this.modalShow=!1,this.$emit("input",!1)},cancel:function(){var e=this;this.modalShow=!1,this.multiple?(this.selIds=[],this.selected.forEach(function(t){e.selIds.push(t)}),this.refreshData(this.data)):(this.selIds=[],this.selIds.push(this.selected),this.refreshData(this.data)),this.$emit("input",!1)},closeModal:function(){this.cancel()},clearSelectedId:function(){this.selIds.splice(0,this.selIds.length),this.refreshData(this.data)},cancelSelectedId:function(e){var t=this.selIds.indexOf(e.cid);-1!==t&&(this.selIds.splice(t,1),this.refreshData(this.data))},deal_data:function(e){return e.list.length>0?(this.$store.commit("buildIdTextMap",{list:e.list,name:"client",ifield:"cid",tfield:"client_name"}),this.refreshData(e.list)):this.multiple&&this.checkAll&&(this.checkAll=!1),e.list},checkSelectAll:function(e,t,i){return-1!==this.selIds.indexOf(e.cid)},refreshData:function(e){var t=this;e.forEach(function(e){-1!==t.selIds.indexOf(e.cid)?e.$selected=!0:e.$selected=!1}),this.multiple&&(this.checkAll=e.every(this.checkSelectAll))},addSelectedId:function(e){-1===this.selIds.indexOf(e)&&(this.selIds.push(e),this.refreshData(this.data))},removeSelectedId:function(e){var t=this.selIds.indexOf(e);-1!==t&&(this.selIds.splice(t,1),this.refreshData(this.data))},replaceSelectedId:function(e){0==this.selIds.length?this.selIds.push(e):this.selIds.splice(0,1,e)},toggleSelected:function(e){this.multiple?e.$selected?this.removeSelectedId(e.cid):this.addSelectedId(e.cid):e.$selected?this.ok():(this.data.forEach(function(e){e.$selected=!1}),e.$selected=!0,this.replaceSelectedId(e.cid))},init_data_cache:function(){this.is_data_init||(this.init_data(),this.is_data_init=!0)},handleCheckAll:function(){var e=this;this.data.forEach(function(t){var i=e.selIds.indexOf(t.cid);!1===e.checkAll?-1==i&&(e.selIds.push(t.cid),t.$selected=!0):i>-1&&(e.selIds.splice(i,1),t.$selected=!1)})}},watch:{value:function(e){this.modalShow=e,this.modalShow?this.init_data_cache():""!=this.params.search_value&&(this.params.search_value="",this.is_data_init=!1)},selected:function(e){this.setSelIds(e)},"$store.state.branch.id":{handler:function(e,t){this.pageIndex=1,this.pageSize=10,this.init_data()}}}}},362:function(e,t,i){"use strict";var s=i(351),a=i(367),n=i(16),l=n(s.a,a.a,!1,null,null,null);l.options.__file="src/views/components/SelectClient.vue",t.a=l.exports},363:function(e,t,i){"use strict";var s=i(352),a=i(368),n=i(16),l=n(s.a,a.a,!1,null,null,null);l.options.__file="src/views/components/SelectClientModal.vue",t.a=l.exports},367:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:e.classes},[i("div",{on:{click:e.openModal}},[e._t("default",[i("div",{ref:"reference",class:[e.prefixCls+"-selection"]},[i("span",{directives:[{name:"show",rawName:"v-show",value:e.showPlaceholder,expression:"showPlaceholder"}],class:[e.prefixCls+"-placeholder"]},[e._v(e._s(e.localePlaceholder))]),e._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:!e.showPlaceholder,expression:"!showPlaceholder"}],class:[e.prefixCls+"-selected-value"],staticStyle:{"line-height":"30px"}},[e._v(e._s(e.labelText))]),e._v(" "),i("Icon",{directives:[{name:"show",rawName:"v-show",value:e.showCloseIcon,expression:"showCloseIcon"}],class:[e.prefixCls+"-arrow"],attrs:{type:"ios-close"},nativeOn:{click:function(t){return t.stopPropagation(),e.clearSelected(t)}}}),e._v(" "),i("Icon",{class:[e.prefixCls+"-arrow"],attrs:{type:"arrow-down-b"}})],1)])],2),e._v(" "),i("select-client-modal",{attrs:{multiple:e.multiple,selected:e.model,width:e.modalWidth,toFormal:e.toFormal},on:{"on-select":e.updateSelected},model:{value:e.modalShow,callback:function(t){e.modalShow=t},expression:"modalShow"}})],1)},a=[];s._withStripped=!0;var n={render:s,staticRenderFns:a};t.a=n},368:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Modal",{directives:[{name:"drag-modal",rawName:"v-drag-modal"}],attrs:{"mask-closable":!1,width:e.width,title:e.title},on:{"on-cancel":e.closeModal},model:{value:e.modalShow,callback:function(t){e.modalShow=t},expression:"modalShow"}},[i("div",{class:e.classes},[i("div",{staticClass:"list-main"},[i("div",{staticClass:"list-condition"},[i("Row",[i("Col",{attrs:{span:"8"}},[i("Input",{directives:[{name:"focusme",rawName:"v-focusme",value:"searchkey",expression:"'searchkey'"}],attrs:{placeholder:"姓名",size:"small"},model:{value:e.params.search_value,callback:function(t){e.$set(e.params,"search_value",t)},expression:"params.search_value"}})],1),e._v(" "),i("Col",{attrs:{span:"10"}},[i("ButtonGroup",[i("Button",{attrs:{type:"primary",icon:"ios-search",size:"small"},on:{click:e.search}},[e._v("查询")])],1),e._v(" "),i("Button",{attrs:{type:"primary",icon:"refresh",size:"small"},on:{click:e.resetSearch}},[e._v("重置")])],1)],1)],1),e._v(" "),i("div",{staticClass:"list-body"},[i("div",{directives:[{name:"loading",rawName:"v-loading.like",value:"students",expression:"'students'",modifiers:{like:!0}}],staticClass:"list-body-wrap"},[i("table",{staticClass:"table table-list"},[i("thead",[i("tr",[e.multiple?i("th",{attrs:{width:"50"},on:{click:e.handleCheckAll}},[i("Checkbox",{model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}})],1):e._e(),e._v(" "),i("th",[e._v("客户名")]),e._v(" "),i("th",[e._v("联系人")]),e._v(" "),i("th",[e._v("电话")]),e._v(" "),i("th",[e._v("联系地址")])])]),e._v(" "),i("tbody",[e._l(e.data,function(t){return i("tr",{class:{"table-info":t.$selected},on:{click:function(i){e.toggleSelected(t)}}},[e.multiple?i("td",[i("Checkbox",{model:{value:t.$selected,callback:function(i){e.$set(t,"$selected",i)},expression:"item.$selected"}})],1):e._e(),e._v(" "),i("td",[e._v(e._s(t.client_name))]),e._v(" "),i("td",[e._v(e._s(t.contact))]),e._v(" "),i("td",[e._v(e._s(t.tel))]),e._v(" "),i("td",[e._v(e._s(t.address))])])}),e._v(" "),0==e.data.length?i("tr",[i("td",{staticStyle:{"text-align":"center"},attrs:{colspan:"5"}},[i("p",{staticClass:"empty"},[e._v("没有找到客户")])])]):e._e()],2)])]),e._v(" "),i("div",{staticClass:"list-page clearfix"},[i("Page",{staticClass:"pull-right",attrs:{size:"small",total:e.total,"show-total":!0,current:e.pageIndex,"show-sizer":!0,"page-size":e.pageSize},on:{"on-change":e.pagenation,"on-page-size-change":e.pagesize}})],1)])]),e._v(" "),this.multiple?i("div",{staticClass:"multi-selected"},[i("Card",[i("div",{attrs:{slot:"title"},slot:"title"},[i("span",[e._v("已选择："),i("span",{staticClass:"badge"},[e._v(e._s(e.selectedTotal))])]),e._v(" "),i("Button",{staticClass:"pull-right",attrs:{type:"ghost",shape:"circle",size:"small",icon:"trash-a",title:"清空"},on:{click:e.clearSelectedId}})],1),e._v(" "),i("ul",{staticClass:"multi-selected-list"},e._l(e.selectedList,function(t){return i("li",[i("span",[e._v(e._s(t.client_name))]),e._v(" "),i("Button",{staticClass:"pull-right",attrs:{type:"ghost",shape:"circle",size:"small",icon:"trash-a",title:"移除"},on:{click:function(i){e.cancelSelectedId(t)}}})],1)}))])],1):e._e()]),e._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[e.multiple?e._e():i("span",{staticClass:"footer-selected pull-left"},[i("i",[e._v("已选择:")]),e._v(e._s(e.labelText))]),e._v(" "),i("Button",{attrs:{type:"default"},on:{click:e.cancel}},[e._v("取消")]),e._v(" "),e.toFormal?i("Button",{directives:[{name:"per",rawName:"v-per",value:"dashboard.toformal",expression:"'dashboard.toformal'"}],attrs:{type:"primary"},on:{click:e.ok}},[e._v("确定转为正式学员")]):i("Button",{attrs:{type:"primary"},on:{click:e.ok}},[e._v("确定")])],1)])},a=[];s._withStripped=!0;var n={render:s,staticRenderFns:a};t.a=n},424:function(e,t,i){"use strict";var s=i(5),a=i(332),n=i(198),l=i(200),o=i(343),r=i(362);t.a={mixins:[a.a,n.a,l.a],components:{selectClient:r.a,dateRangePicker:o.a},data:function(){return{rest_api:"client_services",pk:"cs_id",search_field:{cid:0,searvice_did:0,is_solved:-1},column_keys:{cid:{title:"客户",show:!0},service_did:{title:"服务类型",show:!0},trouble:{title:"问题描述",show:!0},is_solved:{title:"是否解决",show:!0},ename:{title:"服务人员",show:!0}},column_render:{cid:function(e,t){return e("span",t.row.client.client_name)},eid:function(e,t){return e("span",this.$filter("employee_name")(t.row.eid,"系统"))},service_did:function(e,t){return e("span",this.labelDicts(t.row.service_did,"service"))},is_solved:function(e,t){var i={0:{label:"未解决",classes:"text-danger"},1:{label:"解决",classes:"text-success"}},s=i[t.row.is_solved];return e("span",{class:s.classes},s.label)}},operation_keys:{edit:{title:"编辑",type:"edit",per:"employee.edit"},del:{title:"删除",type:"ios-trash",per:"employee.delete"}},operation_func:{edit:function(e){this.editInfo(e.row)},del:function(e){this.delInfo(e.row)}}}},mounted:function(){this.init_data()},methods:{addInfo:function(){var e=this;this.$Modal.open("business/service/info-modal.vue",{on:{"on-success":function(){e.init_data()}}}).then(function(e){e.vuec.show("添加服务记录","add")})},editInfo:function(e){var t=this,i=s.a.sprintf("修改服务记录【%s】",e.client.client_name);this.$Modal.open("business/service/info-modal.vue",{on:{"on-success":function(){t.init_data()}}}).then(function(t){t.vuec.set("info",e).show(i,"edit")})},delInfo:function(e){var t=this,i=s.a.sprintf("确定删除【%s】的服务记录吗？",e.client.client_name);this.confirm(i).then(function(){t.delete(e)})},resetSearch:function(){this.$form("ref_search").reset(),this.init_data()},hook_get_param:function(e){var t=s.a.copy(this.search_field);for(var i in t){var a=t[i];"is_solved"==i?-1!=a&&(e[i]=a):a&&(e[i]=a)}}}}},425:function(e,t,i){"use strict";var s=i(521);t.a={components:{list:s.a}}},521:function(e,t,i){"use strict";var s=i(424),a=i(592),n=i(16),l=n(s.a,a.a,!1,null,null,null);l.options.__file="src/views/business/service/list.vue",t.a=l.exports},592:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"c-grid"},[i("div",{staticClass:"box box-query"},[i("Form",{ref:"ref_search",staticClass:"filter-form row",attrs:{model:e.search_field,"label-width":70}},[i("Form-item",{staticClass:"col-md-3 col-sm-6",attrs:{label:"姓名",prop:"cid"}},[i("select-client",{attrs:{clearable:""},model:{value:e.search_field.cid,callback:function(t){e.$set(e.search_field,"cid",t)},expression:"search_field.cid"}})],1),e._v(" "),i("Form-item",{staticClass:"col-md-3 col-sm-6",attrs:{label:"服务类型",prop:"service_did"}},[i("Select",{model:{value:e.search_field.service_did,callback:function(t){e.$set(e.search_field,"service_did",t)},expression:"search_field.service_did"}},[i("Option",{attrs:{value:0}},[e._v("不限")]),e._v(" "),e._l(e.dicts("service"),function(t){return i("Option",{key:t.did,attrs:{value:t.did}},[e._v("\n\t\t\t\t\t\t\t"+e._s(t.title)+"\n\t\t\t\t\t\t")])})],2)],1),e._v(" "),i("Form-item",{staticClass:"col-md-3 col-sm-6",attrs:{label:"是否解决",prop:"is_solved"}},[i("Select",{model:{value:e.search_field.is_solved,callback:function(t){e.$set(e.search_field,"is_solved",t)},expression:"search_field.is_solved"}},[i("Option",{attrs:{value:-1}},[e._v("不限")]),e._v(" "),i("Option",{attrs:{value:0}},[e._v("未解决")]),e._v(" "),i("Option",{attrs:{value:1}},[e._v("已解决")])],1)],1)],1),e._v(" "),i("Row",{staticClass:"basic"},[i("Col",{staticClass:"mt-2",attrs:{span:"24"}},[i("Button-group",[i("Button",{staticClass:"ml-2",attrs:{type:"primary",icon:"ios-search"},on:{click:e.init_data}},[e._v("查询")])],1),e._v(" "),i("Button",{attrs:{type:"primary",icon:"refresh"},on:{click:e.resetSearch}},[e._v("重置")])],1)],1)],1),e._v(" "),i("div",{staticClass:"box box-result"},[i("div",{staticClass:"toolbar"},[i("Button",{directives:[{name:"per",rawName:"v-per",value:"services.add",expression:"'services.add'"}],attrs:{type:"primary",icon:"plus"},on:{click:e.addInfo}},[e._v("添加")]),e._v(" "),i("filter-column",{attrs:{keys:e.column_keys}})],1),e._v(" "),i("div",{staticClass:"content"},[i("div",{staticClass:"content-body"},[i("Table",{directives:[{name:"loading",rawName:"v-loading.like",value:"client_services",expression:"'client_services'",modifiers:{like:!0}}],ref:"tableExcel",attrs:{"page-size":e.pageSize,page:e.pageIndex,border:!0,stripe:!0,"show-header":!0,data:e.data,columns:e.columns,"no-data-text":e.$store.state.config.EMPTY_DATA_TEXT,"no-filtered-data-text":e.$store.state.config.EMPTY_FILTER_DATA_TEXT},on:{"on-sort-change":e.sortChange}})],1),e._v(" "),i("div",{staticClass:"content-footer"},[i("div",{staticClass:"pagenation"},[i("Page",{attrs:{total:e.total,current:e.pageIndex,"show-sizer":!0,"page-size":e.pageSize,"show-total":!0},on:{"on-change":e.pagenation,"on-page-size-change":e.pagesize}})],1)])])])])},a=[];s._withStripped=!0;var n={render:s,staticRenderFns:a};t.a=n},599:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement;return(e._self._c||t)("list")},a=[];s._withStripped=!0;var n={render:s,staticRenderFns:a};t.a=n}});