webpackJsonp([216],{2093:function(e,t,s){"use strict";var i=s(912),a=s(208);t.a={mixins:[i.a,a.a],data:function(){return this.message_push={title:"收到一条新的考勤通知!",context:"新的考勤通知！学员姓名：圆圆,时间：2018-04-21 10:15,地点：香瑞园校区!",sid:15,message_type:2,relation_id:36,signature:"15459924a44c5dd7f81afe7f63f48804"},this.user_signup={uid:10010,og_id:0,account:"13590400035",mobile:"13590400035",email:"",name:"李三",sex:"1",user_type:2,salt:"pjL86w",password:"8cf98831c80f0561fc64598688d9cbf8",avatar:"",openid:"",default_sid:4,is_mobile_bind:0,is_email_bind:0,is_weixin_bind:0,last_login_time:0,last_login_ip:"",login_times:0,create_time:"2018-04-18 17:22:34",status:1,is_main:0,is_admin:0,update_time:1525921526,create_uid:10001,is_delete:0,delete_time:null,delete_uid:0,reset_time:null,reset_token:null,sid:4,bid:2,student_name:"廖一Yi",pinyin:"",pinyin_abbr:"",nick_name:"Yi",photo_url:"http://s10.xiao360.com/qms/student_avatar/10001/18/04/27/defee772b5c45393098c5581201f2f56.jpeg",birth_time:0,birth_year:0,birth_month:0,birth_day:0,school_grade:0,school_class:"0",school_id:1,first_tel:"13530200068",first_family_name:"廖志强",first_family_rel:4,first_uid:10009,second_family_name:"香瑞园",second_family_rel:0,second_tel:"",second_uid:0,eid:0,sno:"",card_no:"",money:"0.00",credit:"0.00",credit2:"0.00",vip_level:0,last_attendance_time:"2018-05-05 10:15:00",is_lost:0,quit_reason:"",student_type:1,option_fields:[],student_lesson_times:64,student_lesson_remain_times:35,student_lesson_hours:"64.00",student_lesson_remain_hours:"34.00",ext_id:"",first_openid:"",second_openid:"",signature:"03f499c04e01ce35884a3669c95885f8"},{show_form:!1,cfg_name:"org_api",config:{},showMessage:!1,showUserSignup:!1,showUserModify:!1,loading1:!1,loading2:!1,loading3:!1}},methods:{testPush:function(){var e=this;this.loading1=!0,this.$rest("callback").post({url:this.config.message_push_callback_url,data:this.message_push}).success(function(t){e.$Message.success("测试数据发送测试成功！"),e.loading1=!1}).error(function(t){e.loading1=!1,e.$Message.error(t.body.message)})},testSignup:function(){var e=this;this.loading2=!0,this.$rest("callback").post({url:this.config.user_signup_callback_url,data:this.user_signup}).success(function(t){e.$Message.success("测试数据发送成功！"),e.loading2=!1}).error(function(t){e.loading2=!1,e.$Message.error(t.body.message)})},testModify:function(){var e=this;this.loading3=!0,this.$rest("callback").post({url:this.config.user_modify_callback_url,data:this.user_signup}).success(function(t){e.$Message.success("测试数据发送成功！"),e.loading3=!1}).error(function(t){e.loading3=!1,e.$Message.error(t.body.message)})}}}},3163:function(e,t){},3164:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page-grid"},[s("Card",{attrs:{"dis-hover":""}},[s("div",{attrs:{slot:"title"},slot:"title"},[e._v("\n\t        \tAPI接口配置\n\t        ")]),e._v(" "),s("div",[s("Form",{attrs:{"label-width":120,"label-position":"top"}},[s("Form-item",{attrs:{label:"SecretKey"}},[s("Input",{staticStyle:{width:"40%"},attrs:{placeholder:"请输入SecretKey"},model:{value:e.config.secret,callback:function(t){e.$set(e.config,"secret",t)},expression:"config.secret"}})],1),e._v(" "),s("Form-item",{attrs:{label:"消息推送回调URL"}},[s("Input",{staticStyle:{width:"40%"},attrs:{placeholder:"请配置消息推送回调URL"},model:{value:e.config.message_push_callback_url,callback:function(t){e.$set(e.config,"message_push_callback_url",t)},expression:"config.message_push_callback_url"}}),e._v(" "),s("Button",{attrs:{type:"primary",loading:e.loading1},on:{click:e.testPush}},[e._v("测试回调")]),e._v(" "),s("Button",{attrs:{type:"ghost"},on:{click:function(t){e.showMessage=!0}}},[e._v("数据样例")]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showMessage,expression:"showMessage"}],staticClass:"example"},[s("Button",{attrs:{type:"default"},on:{click:function(t){e.showMessage=!1}}},[e._v("关闭")]),e._v(" "),s("p",[e._v("POST:")]),e._v(" "),s("p",[e._v('签名算法: 将所有的键值按a-z排序以后拼接成字符串 key1=v1&key2=v2....keyn=vn 然后再后面加上 &secret=安全码 构成一个新的字符串，然后再md5,签名验证要排除掉 "signature" 字段')]),e._v(" "),s("div",{staticClass:"example-wrap"},[s("pre",[e._v(e._s(e.message_push))])])],1)],1),e._v(" "),s("Form-item",{attrs:{label:"学习管家账号注册回调URL"}},[s("Input",{staticStyle:{width:"40%"},attrs:{placeholder:"请配置用户注册回调URL"},model:{value:e.config.user_signup_callback_url,callback:function(t){e.$set(e.config,"user_signup_callback_url",t)},expression:"config.user_signup_callback_url"}}),e._v(" "),s("Button",{attrs:{type:"primary",loading:e.loading2},on:{click:e.testSignup}},[e._v("测试回调")]),e._v(" "),s("Button",{attrs:{type:"ghost"},on:{click:function(t){e.showUserSignup=!0}}},[e._v("数据样例")]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showUserSignup,expression:"showUserSignup"}],staticClass:"example"},[s("Button",{attrs:{type:"default"},on:{click:function(t){e.showUserSignup=!1}}},[e._v("关闭")]),e._v(" "),s("p",[e._v("POST:")]),e._v(" "),s("p",[e._v('签名算法: 将所有的键值按a-z排序以后拼接成字符串 key1=v1&key2=v2....keyn=vn 然后再后面加上 &secret=安全码 构成一个新的字符串，然后再md5,签名验证要排除掉 "signature" 字段')]),e._v(" "),s("div",{staticClass:"example-wrap"},[s("pre",[e._v(e._s(e.user_signup))])])],1)],1),e._v(" "),s("Form-item",{attrs:{label:"学员信息修改回调URL"}},[s("Input",{staticStyle:{width:"40%"},attrs:{placeholder:"请配置学员信息修改回调URL"},model:{value:e.config.user_modify_callback_url,callback:function(t){e.$set(e.config,"user_modify_callback_url",t)},expression:"config.user_modify_callback_url"}}),e._v(" "),s("Button",{attrs:{type:"primary",loading:e.loading3},on:{click:e.testModify}},[e._v("测试回调")]),e._v(" "),s("Button",{attrs:{type:"ghost"},on:{click:function(t){e.showUserModify=!0}}},[e._v("数据样例")]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showUserModify,expression:"showUserModify"}],staticClass:"example"},[s("Button",{attrs:{type:"default"},on:{click:function(t){e.showUserModify=!1}}},[e._v("关闭")]),e._v(" "),s("p",[e._v("POST:")]),e._v(" "),s("p",[e._v('签名算法: 将所有的键值按a-z排序以后拼接成字符串 key1=v1&key2=v2....keyn=vn 然后再后面加上 &secret=安全码 构成一个新的字符串，然后再md5,签名验证要排除掉 "signature" 字段')]),e._v(" "),s("div",{staticClass:"example-wrap"},[s("pre",[e._v(e._s(e.user_signup))])])],1)],1)],1),e._v(" "),s("div",{staticClass:"footer-btn",staticStyle:{"padding-left":"0"}},[s("Button",{attrs:{type:"primary"},on:{click:function(t){e.handleSubmit()}}},[e._v("保存配置")])],1)],1)])],1)},a=[];i._withStripped=!0;var n={render:i,staticRenderFns:a};t.a=n},614:function(e,t,s){"use strict";function i(e){o||s(3163)}Object.defineProperty(t,"__esModule",{value:!0});var a=s(2093),n=s(3164),o=!1,r=s(11),c=i,l=r(a.a,n.a,!1,c,null,null);l.options.__file="src/views/system/configs/api.vue",t.default=l.exports},675:function(e,t,s){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var a=s(681),n=i(a),o=s(210),r=i(o);t.default=function(){function e(e,t){var s=[],i=!0,a=!1,n=void 0;try{for(var o,c=(0,r.default)(e);!(i=(o=c.next()).done)&&(s.push(o.value),!t||s.length!==t);i=!0);}catch(e){a=!0,n=e}finally{try{!i&&c.return&&c.return()}finally{if(a)throw n}}return s}return function(t,s){if(Array.isArray(t))return t;if((0,n.default)(Object(t)))return e(t,s);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},681:function(e,t,s){e.exports={default:s(682),__esModule:!0}},682:function(e,t,s){s(36),s(26),e.exports=s(683)},683:function(e,t,s){var i=s(56),a=s(3)("iterator"),n=s(18);e.exports=s(2).isIterable=function(e){var t=Object(e);return void 0!==t[a]||"@@iterator"in t||n.hasOwnProperty(i(t))}},912:function(e,t,s){"use strict";var i=s(675),a=s.n(i),n=s(1);t.a={data:function(){return{cfg_name:"",cfg_id:0,config:{},action:"edit",loading:!0}},mounted:function(){this.init_config_data()},methods:{init_config_data:function(){var e=this;this.loading=!0,this.$http.get("configs?cfg_name="+this.cfg_name).then(function(t){if(n.a.isArray(t.body.data)&&0===t.body.data.length)e.action="add";else{0==t.body.data.cfg_id&&(e.action="add");for(var s in t.body.data.cfg_value)e.$set(e.config,s,t.body.data.cfg_value[s]);e.cfg_id=t.body.data.cfg_id}e.initFinished(),e.loading=!1}).catch(function(t){e.$Message.error(t.message)})},initFinished:function(){},handleSubmit:function(){var e=this,t="add"===this.action?["post","configs"]:["put","configs/"+this.cfg_id],s=a()(t,2),i=s[0],o=s[1],r={cfg_name:this.cfg_name,cfg_value:this.config};this.loading=!0,this.$http[i](o,r).then(function(t){var s=e.cfg_name;"lesson"==s&&(s="lesson_config"),"params"==s&&(s="configs"),"org_pc_ui"==s&&(s="quick_navs"),e.$Message.success("保存成功!"),n.a.isDefined(e.$store.state.gvars[s])&&e.$store.dispatch("updateGlobalVar",s),e.init_config_data()}).catch(function(t){e.$Message.error(t.message)})},restoreDefault:function(){var e=this;this.confirm("你确定恢复默认设置吗？").then(function(){e.loading=!0,e.$rest("configs").delete(e.cfg_id).success(function(t){e.$Message.success("恢复成功");var s="";"org_pc_ui"==e.cfg_name&&(s="quick_navs"),"params"==e.cfg_name&&(s="configs"),""!==s&&e.$store.dispatch("updateGlobalVar",s),e.init_config_data()}).error(function(t){e.$Message.error(t.body.message)})})}}}}});