webpackJsonp([264],{1597:function(t,e,s){"use strict";var a=s(0),i=(s.n(a),s(1)),l=s(209),n=s(207),r=s(208);e.a={mixins:[r.a,n.a,l.a],props:{list:{type:Array,default:function(){return[]}},loopCheck:{type:Boolean,default:!1}},data:function(){return{map_week_day:{1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六",7:"星期天"}}},computed:{map_field_text:function(){return{teach_eid:this.$filter("translate")("老师"),second_eid:this.$filter("translate")("助教"),cr_id:"教室冲突",cid:"授课对象",int_hour:"上课时段"}},disabledOK:function(){var t=this.list,e=function(t){return 0==t._loading},s=function(t){return 1==t._success};return t.length!=t.filter(e).length||0==t.filter(s).length}},methods:{getWeekNo:function(t){return i.b.get_date_week_no(new Date(t))},getFieldClass:function(t,e){return e._error_fields&&e._error_fields.length>0&&e._error_fields.indexOf(t)>-1?"text-danger":""},submit:function(){var t=this,e=this.list.filter(function(t){return t._success});e&&e.length>0&&this.$rest("course_arranges/law_course_arranges").post(e).success(function(e){var s=e.data;t.$Notice.success({title:"排课结果",render:function(t){var e=[];return s&&s.success>0&&e.push(t("p",s.success+"条排课创建成功")),s&&s.fail>0&&e.push(t("p",s.fail+"条排课创建失败")),t("div",e)}}),t.$emit("on-success"),t.close()}).error(function(e){t.$Message.error(e.body.message||"排课失败~")})}}}},2194:function(t,e){},2195:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Modal",{directives:[{name:"drag-modal",rawName:"v-drag-modal"}],attrs:{title:"排课计划",width:800},model:{value:t.modal$.show,callback:function(e){t.$set(t.modal$,"show",e)},expression:"modal$.show"}},[t.modal$.show?s("div",{staticStyle:{"max-height":"500px","overflow-y":"auto"}},[s("table",{staticClass:"modal-table"},[s("thead",[s("th",{attrs:{width:"60px"}},[s("div",{staticClass:"ivu-table-cell"},[t._v("#")])]),t._v(" "),s("th",{attrs:{width:"180px"}},[s("div",{staticClass:"ivu-table-cell"},[t._v("日期")])]),t._v(" "),s("th",{attrs:{width:"80px"}},[s("div",{staticClass:"ivu-table-cell"},[t._v("周数")])]),t._v(" "),s("th",[s("div",{staticClass:"ivu-table-cell"},[t._v("排课要素")])]),t._v(" "),s("th",[s("div")])]),t._v(" "),t._l(t.list,function(e,a){return s("tr",{key:a},[s("td",[s("div",{staticClass:"ivu-table-cell"},[t._v(t._s(a+1))])]),t._v(" "),s("td",[s("div",{staticClass:"ivu-table-cell"},[s("tag",{attrs:{color:"green"}},[t._v(t._s(t.map_week_day[e.week_day]))]),t._v("\n\t\t\t\t\t\t"+t._s(e.int_day)+"\n\t\t\t\t\t")],1)]),t._v(" "),s("td",[s("div",{staticClass:"ivu-table-cell"},[t._v(t._s(t.getWeekNo(e.int_day)))])]),t._v(" "),s("td",[s("div",{staticClass:"ivu-table-cell"},[s("p",{class:t.getFieldClass("int_hour",e)},[t._v("\n\t\t\t\t\t\t\t时段："+t._s(e.int_start_hour)+" ~ "+t._s(e.int_end_hour)+"\n\t\t\t\t\t\t")]),t._v(" "),s("p",{class:t.getFieldClass("teach_eid",e)},[t._v("\n\t\t\t\t\t\t\t"+t._s(t._f("translate")("老师"))+"："+t._s(t._f("ename")(e.teach_eid,"-"))+"\n\t\t\t\t\t\t")]),t._v(" "),s("p",{class:t.getFieldClass("second_eid",e)},[t._v("\n\t\t\t\t\t\t\t"+t._s(t._f("translate")("助教"))+"："+t._s(t._f("ename")(e.second_eid,"-"))+"\n\t\t\t\t\t\t")]),t._v(" "),s("p",{class:t.getFieldClass("cr_id",e)},[t._v("\n\t\t\t\t\t\t\t教室："+t._s(t._f("classroom_name")(e.cr_id,"-"))+"\n\t\t\t\t\t\t")]),t._v(" "),s("p",[t._v("\n\t\t\t\t\t\t\t扣课时数："+t._s(e.consume_lesson_hour)+"\n\t\t\t\t\t\t")])])]),t._v(" "),s("td",[s("div",{staticClass:"ivu-table-cell x-flex-cell"},[t.loopCheck&&e._loading?s("div",[s("Spin",{attrs:{fix:""}},[s("Icon",{staticClass:"spin-icon-load",attrs:{type:"load-c",size:"18"}}),t._v(" "),s("div",[t._v("冲突检测中...")])],1)],1):t._e(),t._v(" "),e._fail?s("p",{staticClass:"text-danger"},[t._v("排课冲突 "),s("Icon",{attrs:{type:"close-circled"}})],1):t._e(),t._v(" "),t._l(e._error_fields,function(e){return s("p",{staticClass:"text-danger"},[t._v("【"+t._s(t.map_field_text[e])+"】冲突")])}),t._v(" "),e._fail?t._l(e.error_message,function(e){return s("p",{staticClass:"text-danger"},[t._v(t._s(e))])}):t._e(),t._v(" "),e._success?s("p",{staticClass:"text-success"},[t._v("无冲突 "),s("Icon",{attrs:{type:"checkmark-circled"}})],1):t._e()],2)])])})],2)]):t._e(),t._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[t.loopCheck?s("span",{staticClass:"pull-left text-info"},[t._v("*冲突的排课将会跳过，不生成排课")]):t._e(),t._v(" "),s("Button",{attrs:{type:"ghost",loading:t.saving},on:{click:t.close}},[t._v("关闭")]),t._v(" "),t.loopCheck?s("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.disabledOK},on:{click:t.submit}},[t._v("确定排课")]):t._e()],1)])},i=[];a._withStripped=!0;var l={render:a,staticRenderFns:i};e.a=l},404:function(t,e,s){"use strict";function a(t){n||s(2194)}Object.defineProperty(e,"__esModule",{value:!0});var i=s(1597),l=s(2195),n=!1,r=s(11),_=a,c=r(i.a,l.a,!1,_,"data-v-0e048855",null);c.options.__file="src/views/business/class/arrange/schedule-info-modal.vue",e.default=c.exports}});