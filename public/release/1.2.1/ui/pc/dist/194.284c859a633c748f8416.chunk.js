webpackJsonp([194,241],{1553:function(e,t,s){"use strict";var i=s(1),l=s(209),a=s(207),n=s(208),o=s(754),c={bid:0,sid:0};t.a={mixins:[a.a,n.a,l.a],components:{SelectBranch:o.a},data:function(){return{info:i.b.copy(c),new_bid:0}},methods:{ok:function(){var e=this;return this.new_bid?this.new_bid==this.info.bid?void this.$Message.error("目标校区与当前校区一致，请选择其他校区"):(this.info.bid=this.new_bid,void this.$rest("students/"+this.info.sid).put(this.info).success(function(t){e.$Message.success("转校成功！"),e.$emit("on-success"),e.close()}).error(function(t){e.$Message.error(t.body.message||"转校失败~")})):void this.$Message.error("请选择目标校区")}}}},2104:function(e,t){},2105:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Modal",{directives:[{name:"drag-modal",rawName:"v-drag-modal"}],attrs:{title:e.modal$.title,"mask-closable":!1,width:400},model:{value:e.modal$.show,callback:function(t){e.$set(e.modal$,"show",t)},expression:"modal$.show"}},[e.modal$.show?s("Form",{attrs:{"label-width":80}},[s("Form-item",{attrs:{label:"原校区："}},[s("Tag",[e._v(e._s(e._f("branch_name")(e.info.bid)))])],1),e._v(" "),s("Form-item",{attrs:{label:"目标校区："}},[s("select-branch",{model:{value:e.new_bid,callback:function(t){e.new_bid=t},expression:"new_bid"}})],1)],1):e._e(),e._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("Button",{attrs:{type:"ghost",loading:e.saving},on:{click:e.close}},[e._v("取消")]),e._v(" "),s("Button",{attrs:{type:"primary",loading:e.saving},on:{click:e.ok}},[e._v("确定")])],1)],1)},l=[];i._withStripped=!0;var a={render:i,staticRenderFns:l};t.a=a},340:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(691),l=s(753),a=s(11),n=a(i.a,l.a,!1,null,null,null);n.options.__file="src/views/components/SelectBranchModal.vue",t.default=n.exports},392:function(e,t,s){"use strict";function i(e){n||s(2104)}Object.defineProperty(t,"__esModule",{value:!0});var l=s(1553),a=s(2105),n=!1,o=s(11),c=i,r=o(l.a,a.a,!1,c,null,null);r.options.__file="src/views/business/student/transfer-school.vue",t.default=r.exports},590:function(e,t,s){"use strict";function i(e,t){for(var s=0;s<t.length;s++)if(e===t[s])return!0;return!1}function l(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=e.$children;return i.length&&i.forEach(function(e){var i=e.$options.name,a=e.$children;if(i===t&&s.push(e),a.length){var n=l(e,t,s);n&&s.concat(n)}}),s}t.b=i,s.d(t,"a",function(){return l});window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver},691:function(e,t,s){"use strict";var i=s(54),l=s.n(i),a=s(207),n=s(55),o=s(208),c=(s(24),s(1));t.a={name:"BranchList",mixins:[a.a,n.a,o.a],props:{value:{type:Boolean,default:""},width:{type:String,default:""},title:{type:String,default:"选择校区"},multiple:{type:Boolean,default:!1},selected:{type:[Array,Number],default:[]}},data:function(){return{params:{search_field:"branch_name",search_value:"",order_field:"",order_sort:"",last_search_value:""},modalShow:!1,pageIndex:1,pageSize:10,totalCount:0,data:[],selIds:[],is_data_init:!1,checkAll:!1}},computed:{total:function(){return this.totalCount},classes:function(){var e;return["select-list",(e={},l()(e,"select-list-multiple",this.multiple),l()(e,"select-list-single",!this.multiple),e)]},labelText:function(){if(this.selIds.length>0){var e=this.$filter("branch_name")(this.selIds[0]);return e||""}},selectedTotal:function(){return this.selIds.length},selectedList:function(){var e=this,t=[];return this.selIds.forEach(function(s){s>0&&t.push(e.getObjById(s))}),t}},mounted:function(){this.init_data(),this.refreshSelId(this.selected)},methods:{pagesize:function(e){this.pageSize=e,this.init_data()},pagenation:function(e){this.pageIndex=e,this.init_data()},search:function(){if(/^\s*$/.test(this.params.search_value)&&""==this.params.last_search_value)return void this.focus("searchkey");this.pagenation(1)},resetSearch:function(){this.params.search_value="",this.init_data()},init_data:function(){var e=this,t=[],s=this.$store.state.gvars.branchs,i=void 0,l=void 0,a=void 0;this.is_admin||(s=s.filter(function(t){return e.bids_user.indexOf(t.bid)>-1})),/^\s*$/.test(this.params.search_value)||(s=s.filter(function(t){return-1!==t[e.params.search_field].indexOf(e.params.search_value)})),this.totalCount=s.length,i=(this.pageIndex-1)*this.pageSize,l=i+this.pageSize,a=0,s.forEach(function(e){a>=i&&a<l&&t.push(c.b.copy(e)),a++}),this.data=t,this.refreshData(t)},getObjById:function(e){var t=this.$store.state.gvars.branchs.find(function(t){return t.bid==e});return t?c.b.copy(t):null},ok:function(){if(!this.selectedTotal)return void this.$Message.error("没有选中任何校区");if(this.multiple)this.$emit("on-select",this.selectedList);else{var e=this.$store.getters.getMapObject(this.selIds[0],"branch");this.$emit("on-select",e)}this.modalShow=!1,this.$emit("input",!1)},cancel:function(){var e=this;this.modalShow=!1,this.multiple?(this.selIds=[],this.selected.forEach(function(t){e.selIds.push(t)}),this.refreshData(this.data)):(this.selIds=[],this.selIds.push(this.selected),this.refreshData(this.data)),this.$emit("input",!1)},closeModal:function(){this.cancel()},clearSelectedId:function(){this.selIds.splice(0,this.selIds.length),this.refreshData(this.data)},cancelSelectedId:function(e){var t=this.selIds.indexOf(e.bid);-1!==t&&(this.selIds.splice(t,1),this.refreshData(this.data))},checkSelectAll:function(e,t,s){return-1!==this.selIds.indexOf(e.bid)},refreshData:function(e){var t=this;e.forEach(function(e){-1!==t.selIds.indexOf(e.bid)?e.$selected=!0:e.$selected=!1}),this.multiple&&(this.checkAll=e.every(this.checkSelectAll))},addSelectedId:function(e){-1===this.selIds.indexOf(e)&&(this.selIds.push(e),this.refreshData(this.data))},removeSelectedId:function(e){var t=this.selIds.indexOf(e);-1!==t&&(this.selIds.splice(t,1),this.refreshData(this.data))},replaceSelectedId:function(e){0==this.selIds.length?this.selIds.push(e):this.selIds.splice(0,1,e)},toggleSelected:function(e){this.multiple?e.$selected?this.removeSelectedId(e.bid):this.addSelectedId(e.bid):e.$selected?this.ok():(this.data.forEach(function(e){e.$selected=!1}),e.$selected=!0,this.replaceSelectedId(e.bid))},init_data_cache:function(){this.is_data_init||(this.init_data(),this.is_data_init=!0)},handleCheckAll:function(){var e=this;this.data.forEach(function(t){var s=e.selIds.indexOf(t.bid);!1===e.checkAll?-1==s&&(e.selIds.push(t.bid),t.$selected=!0):s>-1&&(e.selIds.splice(s,1),t.$selected=!1)})},refreshSelId:function(e){var t=this;null!==e&&0!==e.length&&""!==e&&0!==e||(this.selIds=[],this.refreshData(this.data)),this.multiple?e.forEach(function(e){-1==t.selIds.indexOf(e)&&t.selIds.push(e)}):0==this.selIds.length?this.selIds.push(e):this.selIds.splice(0,1,e)}},watch:{value:function(e){this.modalShow=e,this.modalShow?this.init_data_cache():""!=this.params.search_value&&(this.params.search_value="",this.is_data_init=!1)},selected:function(e){this.refreshSelId(e)}}}},693:function(e,t,s){"use strict";var i=s(54),l=s.n(i),a=s(590),n=s(340),o=(s(24),s(1),s(207)),c="ivu-select";t.a={name:"SelectBranch",mixins:[o.a],components:{SelectBranchModal:n.default},props:{value:{type:[String,Number,Array],default:""},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},placeholder:{type:String},loading:{type:Boolean,default:!1},loadingText:{type:String},size:{validator:function(e){return Object(a.b)(e,["small","large","default"])}},notFoundText:{type:String},placement:{validator:function(e){return Object(a.b)(e,["top","bottom"])},default:"bottom"}},data:function(){return{prefixCls:c,modalShow:!1,options:[],optionsInstances:[],labelText:"",model:this.value}},created:function(){this.model=this.value,this.updateLabelText()},computed:{modalWidth:function(){return this.multiple?"900":"640"},multiple:function(){return!!Array.isArray(this.model)},classes:function(){var e;return["ivu-select",(e={},l()(e,"ivu-select-visible",this.visible),l()(e,"ivu-select-disabled",this.disabled),l()(e,"ivu-select-multiple",this.multiple),l()(e,"ivu-select-single",!this.multiple),l()(e,"ivu-select-show-clear",this.showCloseIcon),l()(e,"ivu-select-"+this.size,!!this.size),e)]},showPlaceholder:function(){var e=!1;return"string"==typeof this.model?""!==this.model&&"0"!==this.model||(e=!0):Array.isArray(this.model)?this.model.length||(e=!0):"number"==typeof this.model?0==this.model&&(e=!0):null===this.model&&(e=!0),e},localePlaceholder:function(){return void 0===this.placeholder?"请选择":this.placeholder},showCloseIcon:function(){return this.clearable&&!this.showPlaceholder}},methods:{openModal:function(){if(this.disabled)return!1;this.modalShow=!this.modalShow},updateSelected:function(e){var t=this;this.multiple?(this.model.length>0&&this.model.splice(0,this.model.length),e.forEach(function(e){t.model.push(e.bid)})):this.model=e.bid,this.updateLabelText(),this.$emit("input",this.model),this.dispatch("FormItem","on-form-change",this.model)},updateLabelText:function(){var e=this;this.multiple?this.model.length>0&&this.model[0]>0?this.$store.dispatch("getMapText",{id:this.model[0],name:"branch",idf:"bid",txf:"branch_name"}).then(function(t){var s=t;e.model.length>1&&(s+="等"+e.model.length+"个校区"),e.labelText=s}):this.labelText="":this.model?this.$store.dispatch("getMapText",{id:this.model,name:"branch",idf:"bid",txf:"branch_name"}).then(function(t){e.labelText=t}):this.labelText=""},clearSelected:function(){this.multiple?this.model.length>0&&this.model.splice(0,this.model.length):this.model=0,this.$emit("input",this.model),this.dispatch("FormItem","on-form-change",this.model)}},watch:{value:function(e){this.model=e,this.updateLabelText()}}}},753:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Modal",{directives:[{name:"drag-modal",rawName:"v-drag-modal"}],attrs:{"mask-closable":!0,width:e.width,title:e.title},on:{"on-cancel":e.closeModal},model:{value:e.modalShow,callback:function(t){e.modalShow=t},expression:"modalShow"}},[s("div",{class:e.classes},[s("div",{staticClass:"list-main"},[s("div",{staticClass:"list-condition"},[s("Row",[s("Col",{attrs:{span:"8"}},[s("Input",{directives:[{name:"focusme",rawName:"v-focusme",value:"searchkey",expression:"'searchkey'"}],attrs:{placeholder:"校区名称",size:"small"},model:{value:e.params.search_value,callback:function(t){e.$set(e.params,"search_value",t)},expression:"params.search_value"}})],1),e._v(" "),s("Col",{attrs:{span:"10"}},[s("ButtonGroup",[s("Button",{attrs:{type:"primary",icon:"ios-search",size:"small"},on:{click:e.search}},[e._v("查询")])],1),e._v(" "),s("Button",{attrs:{type:"primary",icon:"refresh",size:"small"},on:{click:e.resetSearch}},[e._v("重置")])],1)],1)],1),e._v(" "),s("div",{staticClass:"list-body"},[s("div",{staticClass:"list-body-wrap"},[s("table",{staticClass:"table-list"},[s("thead",[s("tr",[e.multiple?s("th",{attrs:{width:"50"}},[s("div",{staticClass:"ivu-table-cell"},[s("Checkbox",{nativeOn:{click:function(t){e.handleCheckAll(t)}},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}})],1)]):e._e(),e._v(" "),s("th",[s("div",{staticClass:"ivu-table-cell"},[e._v("校区")])]),e._v(" "),s("th",[s("div",{staticClass:"ivu-table-cell"},[e._v("简称")])]),e._v(" "),s("th",[s("div",{staticClass:"ivu-table-cell"},[e._v("电话")])]),e._v(" "),s("th",[s("div",{staticClass:"ivu-table-cell"},[e._v("地址")])])])]),e._v(" "),s("tbody",[e._l(e.data,function(t){return s("tr",{class:{"table-info":t.$selected},on:{click:function(s){e.toggleSelected(t)}}},[e.multiple?s("td",[s("div",{staticClass:"ivu-table-cell"},[s("Checkbox",{model:{value:t.$selected,callback:function(s){e.$set(t,"$selected",s)},expression:"item.$selected"}})],1)]):e._e(),e._v(" "),t?s("td",[s("div",{staticClass:"ivu-table-cell"},[e._v(e._s(t.branch_name))])]):e._e(),e._v(" "),s("td",[s("div",{staticClass:"ivu-table-cell"},[e._v(e._s(t.short_name))])]),e._v(" "),s("td",[s("div",{staticClass:"ivu-table-cell"},[e._v(e._s(t.branch_tel))])]),e._v(" "),s("td",[s("div",{staticClass:"ivu-table-cell"},[e._v(e._s(t.address))])])])}),e._v(" "),0==e.data.length?s("tr",[s("td",{staticStyle:{"text-align":"center"},attrs:{colspan:"5"}},[s("p",{staticClass:"empty"},[e._v("没有找到校区")])])]):e._e()],2)])]),e._v(" "),s("div",{staticClass:"list-page clearfix"},[s("Page",{staticClass:"pull-right",attrs:{size:"small",total:e.total,"show-total":!0,current:e.pageIndex,"show-sizer":!0,"page-size":e.pageSize},on:{"on-change":e.pagenation,"on-page-size-change":e.pagesize}})],1)])]),e._v(" "),this.multiple?s("div",{staticClass:"multi-selected"},[s("Card",[s("div",{attrs:{slot:"title"},slot:"title"},[s("span",[e._v("已选择："),s("span",{staticClass:"badge"},[e._v(e._s(e.selectedTotal))])]),e._v(" "),s("Button",{staticClass:"pull-right",attrs:{type:"ghost",shape:"circle",size:"small",icon:"trash-a",title:"清空"},on:{click:e.clearSelectedId}})],1),e._v(" "),s("ul",{staticClass:"multi-selected-list"},e._l(e.selectedList,function(t){return s("li",[t?s("span",[e._v(e._s(t.branch_name))]):e._e(),e._v(" "),s("Button",{staticClass:"pull-right",attrs:{type:"ghost",shape:"circle",size:"small",icon:"trash-a",title:"移除"},on:{click:function(s){e.cancelSelectedId(t)}}})],1)}))])],1):e._e()]),e._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[e.multiple?e._e():s("span",{staticClass:"footer-selected pull-left"},[s("i",[e._v("已选择:")]),e._v(e._s(e.labelText))]),e._v(" "),s("Button",{attrs:{type:"default"},on:{click:e.cancel}},[e._v("取消")]),e._v(" "),s("Button",{attrs:{type:"primary"},on:{click:e.ok}},[e._v("确定")])],1)])},l=[];i._withStripped=!0;var a={render:i,staticRenderFns:l};t.a=a},754:function(e,t,s){"use strict";var i=s(693),l=s(769),a=s(11),n=a(i.a,l.a,!1,null,null,null);n.options.__file="src/views/components/SelectBranch.vue",t.a=n.exports},769:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:e.classes},[s("div",{ref:"reference",class:[e.prefixCls+"-selection"],on:{click:e.openModal}},[s("span",{directives:[{name:"show",rawName:"v-show",value:e.showPlaceholder,expression:"showPlaceholder"}],class:[e.prefixCls+"-placeholder"]},[e._v(e._s(e.localePlaceholder))]),e._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:!e.showPlaceholder,expression:"!showPlaceholder"}],class:[e.prefixCls+"-selected-value"]},[e._v(e._s(e.labelText))]),e._v(" "),s("Icon",{directives:[{name:"show",rawName:"v-show",value:e.showCloseIcon,expression:"showCloseIcon"}],class:[e.prefixCls+"-arrow"],attrs:{type:"ios-close"},nativeOn:{click:function(t){t.stopPropagation(),e.clearSelected(t)}}}),e._v(" "),s("Icon",{directives:[{name:"show",rawName:"v-show",value:!e.showCloseIcon,expression:"!showCloseIcon"}],class:[e.prefixCls+"-arrow"],attrs:{type:"arrow-down-b"}})],1),e._v(" "),s("select-branch-modal",{attrs:{multiple:e.multiple,selected:e.model,width:e.modalWidth},on:{"on-select":e.updateSelected},model:{value:e.modalShow,callback:function(t){e.modalShow=t},expression:"modalShow"}})],1)},l=[];i._withStripped=!0;var a={render:i,staticRenderFns:l};t.a=a}});